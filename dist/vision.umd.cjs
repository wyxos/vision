(function(d,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("axios"),require("moment"),require("@oruga-ui/oruga-next")):typeof define=="function"&&define.amd?define(["exports","vue","axios","moment","@oruga-ui/oruga-next"],t):(d=typeof globalThis<"u"?globalThis:d||self,t(d.Vision={},d.Vue,d.axios,d.moment,d.Oruga))})(this,function(d,t,h,V,$){"use strict";var Cs=Object.defineProperty;var Vs=(d,t,h)=>t in d?Cs(d,t,{enumerable:!0,configurable:!0,writable:!0,value:h}):d[t]=h;var u=(d,t,h)=>Vs(d,typeof t!="symbol"?t+"":t,h);const ce={class:"wyxos-accordion"},R={__name:"WyxosAccordion",props:{active:{type:Boolean,required:!1}},setup(o){const e=o,s=t.ref(!1),n=()=>{s.value=!s.value};return t.onMounted(()=>{s.value=e.active}),(r,i)=>(t.openBlock(),t.createElementBlock("div",ce,[t.renderSlot(r.$slots,"header",{isOpen:s.value,toggle:n}),s.value?t.renderSlot(r.$slots,"body",{key:0}):t.createCommentVNode("",!0)]))}},de=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));class A{constructor(e){u(this,"type","switch");u(this,"field","");u(this,"url","");u(this,"processing",t.ref(null));u(this,"target",t.ref(null));u(this,"beforeCallback",null);u(this,"afterCallback",null);u(this,"error",null);this.url=e}static create(e){return new this(e)}async patch(e,s){var n,r;if(this.target.value=e,this.processing.value=e.id,this.beforeCallback&&this.beforeCallback(e,s)===!1){this.processing.value=null,this.target.value=null;return}await new Promise(i=>setTimeout(i,1e3));try{const i=typeof this.url=="function"?this.url(e):this.url;return this.processing.value=null,this.target.value=null,await h.patch(i,s).then(a=>(this.processing.value=null,this.target.value=null,this.afterCallback&&this.afterCallback(a),a))}catch(i){this.processing.value=null,this.target.value=null,this.error=((r=(n=i.response)==null?void 0:n.data)==null?void 0:r.message)||i.message}}async delete(e){var s,n;if(this.target.value=e,this.processing.value=e.id,this.beforeCallback&&this.beforeCallback(e)===!1){this.processing.value=null,this.target.value=null;return}await new Promise(r=>setTimeout(r,1e3));try{const r=typeof this.url=="function"?this.url(e):this.url;return h.delete(r).then(i=>(this.processing.value=null,this.target.value=null,this.afterCallback&&this.afterCallback(i),i))}catch(r){return this.error=((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||r.message,this.processing.value=null,this.target.value=null,r}}before(e){return this.beforeCallback=e,this}after(e){return this.afterCallback=e,this}isProcessing(e){return this.processing.value===e.id}}const ue=["disabled"],me={key:0,class:"fas fa-spinner fa-spin"},he={key:1,class:t.normalizeClass("fas fa-trash")},M={__name:"WyxosAction",props:{action:{type:A,required:!0},row:{type:Object,required:!0}},setup(o){return(e,s)=>(t.openBlock(),t.createElementBlock("button",{disabled:o.action.isProcessing(o.row),class:"bg-red-500 text-white",onClick:s[0]||(s[0]=n=>o.action.delete(o.row))},[o.action.isProcessing(o.row)?(t.openBlock(),t.createElementBlock("i",me)):(t.openBlock(),t.createElementBlock("i",he))],8,ue))}},fe=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"})),y=t.reactive({default:[]});function x(){return{createBag(o){y[o]||(y[o]=[])},set(o,e="default"){if(!(o.response&&o.response.data&&o.response.data.errors))throw o;y[e]=Object.keys(o.response.data.errors).map(n=>({key:n,message:o.response.data.errors[n][0]}))},has(o,e="default"){return y[e].some(s=>s.key===o)},setOne(o,e,s="default"){const n=y[s];if(!n){y[s]=[{key:o,message:e}];return}const r=n.findIndex(i=>i.key===o);if(r!==-1){n[r].message=e;return}n.push({key:o,message:e})},get(o,e="default"){const s=y[e];if(!s)return{message:"",variant:""};const n=s.find(r=>Array.isArray(o)?o.includes(r.key):r.key===o);return n?{message:n.message,variant:"danger"}:{message:"",variant:""}},clear(o=null,e="default"){if(o){const s=y[e];if(!s){console.warn(`Bag ${e} is not defined.`);return}const n=s.findIndex(r=>r.key===o);n!==-1&&s.splice(n,1);return}y[e]=[]},all(o="default"){return y[o]}}}class g{constructor(e={}){u(this,"submitUrl",null);u(this,"loadUrl",null);u(this,"original",{});u(this,"form",t.reactive({}));u(this,"abortSubmitController",null);u(this,"abortLoadController",null);u(this,"submitState",t.ref(""));u(this,"loadState",t.ref(""));u(this,"errors",x());u(this,"resetAfterSubmitFlag",!1);u(this,"callbacks",{submit:null,load:null,success:null,failure:null,formatter:null});return this.setAttributes(e),new Proxy(this,{get(s,n,r){if(Reflect.has(s,n))return Reflect.get(s,n,r);if(Reflect.has(s.form,n)){const i=n.split(".");if(i.length>1){let a=s.form;for(let l=0;l<i.length;l++)a=a[i[l]];return a??void 0}return Reflect.get(s.form,n)}},set(s,n,r,i){if(Reflect.has(s,n))return Reflect.set(s,n,r,i);if(Reflect.has(s.form,n)){const a=n.split(".");if(a.length>1){let l=s.form;for(let c=0;c<a.length-1;c++)a[c]in l||(l[a[c]]={}),l=l[a[c]];return l[a[a.length-1]]===void 0?!1:(l[a[a.length-1]]=r,!0)}return Reflect.set(s.form,n,r)}return!1}})}get isDirty(){const e=s=>Array.isArray(s)?s.map(e):s&&typeof s=="object"?Object.keys(s).sort().reduce((n,r)=>(n[r]=e(s[r]),n),{}):s;return JSON.stringify(e(this.original))!==JSON.stringify(e(this.form))}get isSubmitting(){return this.submitState.value==="loading"}get isSubmitted(){return this.submitState.value==="loaded"}get isSubmitFailed(){return this.submitState.value==="failed"}static create(e){return new this(e)}resetAfterSubmit(e=!0){return this.resetAfterSubmitFlag=e,this}setAttributes(e){return this.original=e,Object.assign(this.form,this.original),this}submitAt(e){return this.submitUrl=e,this}async submit(){this.submitting(),this.clearErrors();const e={};this.abortSubmitController&&this.abortSubmitController.abort(),this.abortSubmitController=new AbortController,e.signal=this.abortSubmitController.signal,await new Promise(n=>setTimeout(n,1e3));const s=this.callbacks.formatter?this.callbacks.formatter(this.form):this.form;return h.post(this.submitUrl,s,e).then(n=>(this.submitted(),this.resetAfterSubmitFlag&&this.setAttributes(this.original),this.callbacks.success?this.callbacks.success(n.data):n.data)).catch(n=>(this.submitFailed(),this.errors.set(n),Promise.reject(n)))}load(){this.loading();const e={};return this.abortLoadController&&this.abortLoadController.abort(),this.abortLoadController=new AbortController,e.signal=this.abortLoadController.signal,h.get(this.loadUrl,e).then(s=>(this.loaded(),s.data.form&&this.setAttributes(s.data.form),s.data)).catch(s=>(this.loadFailed(),Promise.reject(s)))}submitting(){this.submitState.value="loading"}submitted(){this.submitState.value="loaded"}submitFailed(){this.submitState.value="failed"}loading(){this.loadState.value="loading"}loaded(){this.loadState.value="loaded"}loadFailed(){this.loadState.value="failed"}formatter(e){return this.callbacks.formatter=e,this}loadFrom(e){return this.loadUrl=e,this}getError(e){return this.errors.get(e)}hasError(e){return this.errors.has(e)}clearError(e){this.errors.clear(e)}clearErrors(){this.errors.clear()}getErrors(){return this.errors.all()}onSuccess(e){return this.callbacks.success=e,this}onFailure(e){return this.callbacks.failure=e,this}toJson(){return JSON.parse(JSON.stringify(this.form))}}const f=(o,e)=>{const s=o.__vccOpts||o;for(const[n,r]of e)s[n]=r;return s},pe={name:"WyxosButton",props:{form:{type:g,default:null},button:{type:String,default:"submit"}}},ge=["disabled","type"],ye={key:0},be={key:1},_e=t.createElementVNode("i",{class:"fas fa-spinner fa-spin ml-4"},null,-1);function Se(o,e,s,n,r,i){return t.openBlock(),t.createElementBlock("button",{disabled:s.form.isSubmitting,type:s.button},[t.renderSlot(o.$slots,"default",{},()=>[s.form.isSubmitting?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("span",ye,"Submit")),s.form.isSubmitting?(t.openBlock(),t.createElementBlock("span",be,"Processing")):t.createCommentVNode("",!0)]),s.form.isSubmitting?t.renderSlot(o.$slots,"icon",{key:0},()=>[_e]):t.createCommentVNode("",!0)],8,ge)}const I=f(pe,[["render",Se]]),we=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"})),ke={name:"WyxosCollection",props:{modelValue:{required:!0,type:Array}},emits:["update:modelValue"],data(){return{items:[]}},mounted(){this.items=this.modelValue},methods:{add(o){this.items.push(o),this.$emit("update:modelValue",this.items)},remove(o){this.items.splice(o,1),this.$emit("update:modelValue",this.items)}}},Ce=t.createElementVNode("ul",null,[t.createElementVNode("li")],-1);function Ve(o,e,s,n,r,i){return t.renderSlot(o.$slots,"default",t.normalizeProps(t.guardReactiveProps({add:i.add,remove:i.remove,items:r.items})),()=>[Ce])}const z=f(ke,[["render",Ve]]),xe=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));class w{constructor(){u(this,"state",t.reactive({isLoading:!1,isLoaded:!1,isFailure:!1}))}get isLoading(){return this.state.isLoading}get isLoaded(){return this.state.isLoaded}get isFailure(){return this.state.isFailure}isState(e){return this.state[e]}loading(){Object.assign(this.state,{isLoading:!0,isLoaded:!1,isFailure:!1})}loaded(){Object.assign(this.state,{isLoading:!1,isLoaded:!0,isFailure:!1})}failed(){Object.assign(this.state,{isLoading:!1,isLoaded:!1,isFailure:!0})}reset(){Object.assign(this.state,{isLoading:!1,isLoaded:!1,isFailure:!1})}static create(){return new w}}const Ee={name:"WyxosConfirm",props:{title:{type:String,default:"Title"},message:{type:String,default:""},confirmText:{type:String,default:""},confirmType:{type:String,default:""},cancelText:{type:String,default:""},loading:{type:Boolean},callback:{type:Function,default:null}},emits:["close"],setup(){return{state:new w}},methods:{async proceed(){this.callback&&(this.state.loading(),await this.callback().catch(o=>{throw this.state.failed(),o}),this.state.loaded()),this.$emit("close",{action:!0})}}},$e={class:"bg-white p-6"},Be={class:"title"},Oe={class:"mb-6"},Ne={class:"buttons",role:"group"};function Te(o,e,s,n,r,i){const a=t.resolveComponent("wyxos-button"),l=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{active:!0,onClose:e[2]||(e[2]=c=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createElementVNode("section",$e,[t.createElementVNode("article",null,[t.createElementVNode("header",null,[t.createElementVNode("h3",Be,t.toDisplayString(s.title),1)]),t.createElementVNode("p",Oe,t.toDisplayString(s.message),1),t.createElementVNode("footer",Ne,[t.createVNode(a,{disabled:n.state.isLoading,class:"button secondary","native-type":"button",onClick:e[0]||(e[0]=c=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.cancelText),1)]),_:1},8,["disabled"]),t.createVNode(a,{class:t.normalizeClass([{[s.confirmType]:!0},"button"]),loading:n.state.isLoading,"native-type":"button",onClick:e[1]||(e[1]=c=>i.proceed())},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.confirmText),1)]),_:1},8,["class","loading"])])])])]),_:1})}const D=f(Ee,[["render",Te]]),We=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"})),je={name:"WyxosDatepicker",props:{modelValue:{required:!0,type:[null,String]},displayFormat:{type:String,default:"DD/MM/YYYY"},submitFormat:{type:String,default:"YYYY-MM-DD"},label:{type:String,default:null},name:{type:String,default:null},form:{type:g,default:null},options:{type:Object,default(){return{}}}},emits:["update:modelValue"],data(){return{query:null}},computed:{mergedOptions(){return{enableTimePicker:!1,autoApply:!0,...this.options}}},watch:{modelValue:{handler(o){this.query=o?V(o,this.submitFormat)._d:null},immediate:!0,deep:!0}},mounted(){this.modelValue&&(this.query=V(this.modelValue,this.submitFormat)._d)},methods:{dateFormatter(o){return o?V(o).format(this.displayFormat):null},updateQuery(){var o;this.$emit("update:modelValue",this.query?V(this.query).format(this.submitFormat):null),(o=this.form)==null||o.clearError(this.name)}}};function Pe(o,e,s,n,r,i){var c;const a=t.resolveComponent("o-datepicker"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({label:s.label},(c=s.form)==null?void 0:c.getError(s.name)),{default:t.withCtx(()=>[t.createVNode(a,t.mergeProps({modelValue:r.query,"onUpdate:modelValue":e[0]||(e[0]=m=>r.query=m),"date-formatter":i.dateFormatter,"trap-focus":""},s.options,{"onUpdate:modelValue":i.updateQuery}),null,16,["modelValue","date-formatter","onUpdate:modelValue"])]),_:1},16,["label"])}const U=f(je,[["render",Pe]]),qe=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"})),Le=t.defineComponent({name:"WyxosError",props:{form:{type:g,default:null},name:{type:String,required:!0}},setup(){return{errors:x()}}}),Fe={key:0,class:"wyxos-error"},Re={key:1,class:"wyxos-error"};function Ae(o,e,s,n,r,i){var a,l;return(a=o.form)!=null&&a.getError(o.name).message?(t.openBlock(),t.createElementBlock("span",Fe,t.toDisplayString(o.form.getError(o.name).message),1)):(l=o.errors.get(o.name))!=null&&l.message?(t.openBlock(),t.createElementBlock("span",Re,t.toDisplayString(o.errors.get(o.name).message),1)):t.createCommentVNode("",!0)}const Y=f(Le,[["render",Ae]]),Me=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));class C{constructor(e){u(this,"loadUrl","");u(this,"loadingState",t.ref(null));u(this,"originalQuery",{});u(this,"appliedQuery",{});u(this,"appliedQueryLabel",{});u(this,"attributes",t.reactive({response:{listing:{items:[],showing:0,perPage:0,total:0}},query:{page:1,perPage:10}}));return this.originalQuery=e,this.appliedQuery=e,Object.assign(this.attributes.query,e),new Proxy(this,{get(s,n,r){if(Reflect.has(s,n))return Reflect.get(s,n,r);if(Reflect.has(s.attributes.query,n)){const i=n.split(".");if(i.length>1){let a=s.attributes.query;for(let l=0;l<i.length;l++)a=a[i[l]];return a??void 0}return Reflect.get(s.attributes.query,n)}},set(s,n,r,i){if(Reflect.has(s,n))return Reflect.set(s,n,r,i);if(Reflect.has(s.attributes.query,n)){const a=n.split(".");if(a.length>1){let l=s.form;for(let c=0;c<a.length-1;c++)a[c]in l||(l[a[c]]={}),l=l[a[c]];return l[a[a.length-1]]===void 0?!1:(l[a[a.length-1]]=r,!0)}return Reflect.set(s.attributes.query,n,r)}return!1}})}get config(){return{data:this.attributes.response.listing.items,total:this.attributes.response.listing.total,currentPage:this.attributes.query.page,perPage:this.attributes.query.perPage,loading:this.isLoading,paginated:this.attributes.response.listing.total>this.attributes.response.listing.perPage,backendPagination:!0,striped:!0}}get events(){return{pageChange:e=>this.onPageChange(e)}}get isLoading(){return this.loadingState.value==="loading"}get activeAttributes(){return Object.keys(this.attributes.query).filter(e=>this.appliedQueryLabel[e]).filter(e=>this.appliedQuery[e]!==null&&this.appliedQuery[e]!==void 0&&this.appliedQuery[e]!==""&&this.appliedQuery[e]!=="all").map(e=>({key:e,label:this.renderLabel(e),value:this.appliedQuery[e]}))}static create(e){return new C(e)}search(e={}){return typeof e=="function"?e=Object.assign({},this.attributes.query,e(this.attributes.query)):e=Object.assign({},this.attributes.query,e),this.loading(),h.get(this.loadUrl,{params:e}).then(s=>(Object.assign(this.attributes.response,s.data),this.appliedQuery=JSON.parse(JSON.stringify(e)),s)).finally(()=>{this.loadingState.value="loaded"})}load(e={}){return this.attributes.query.page=1,typeof e=="function"?e=Object.assign({},this.attributes.query,e(this.attributes.query)):e=Object.assign({},this.attributes.query,e),this.loading(),h.get(this.loadUrl,{params:e}).then(s=>(Object.assign(this.attributes.response,s.data),this.appliedQuery=this.originalQuery,s)).finally(()=>{this.loadingState.value="loaded"})}loading(){this.loadingState.value="loading"}displayAs(e){return this.appliedQueryLabel=e,this}renderLabel(e){return this.appliedQueryLabel[e]}onPageChange(e){return this.attributes.query.page=e,this.search()}clearAttribute(e){return this.attributes.query[e]=this.originalQuery[e],this.search()}reset(){return Object.assign(this.attributes.query,this.originalQuery),this.load()}loadFrom(e){return this.loadUrl=e,this}}const Ie={name:"WyxosForm",props:{form:{type:g,required:!0},submit:{type:[Function,Promise],default:null},listing:{type:C,default:null},reset:{type:[Boolean,Function],default:!1},formClass:{type:[String,Array,Object],default:null}},emits:["submitted"],methods:{async handle(){if(this.submit?await this.submit(this.form):await this.form.submit(),this.reset&&(typeof this.reset=="function"?this.reset():this.form.reset()),this.$emit("submitted"),this.listing)return this.listing.reload()}}};function ze(o,e,s,n,r,i){const a=t.resolveComponent("o-loading"),l=t.resolveComponent("o-button");return s.form.isLoaded?(t.openBlock(),t.createElementBlock("form",{key:0,class:t.normalizeClass(s.formClass),onSubmit:e[0]||(e[0]=t.withModifiers(c=>i.handle(),["prevent"]))},[t.renderSlot(o.$slots,"default")],34)):s.form.isLoading?(t.openBlock(),t.createBlock(a,{key:1,active:!0})):s.form.isFailure?(t.openBlock(),t.createBlock(l,{key:2,onClick:e[1]||(e[1]=c=>s.form.load())},{default:t.withCtx(()=>[t.createTextVNode(" Error. Retry or refresh. ")]),_:1})):t.createCommentVNode("",!0)}const Q=f(Ie,[["render",ze]]),De=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"})),v={__name:"WyxosIcon",props:{active:{type:Boolean,required:!1},on:{type:String,required:!1,default:"chevron-down"},off:{type:String,required:!1,default:"chevron-right"}},setup(o){return(e,s)=>(t.openBlock(),t.createElementBlock("i",{class:t.normalizeClass([`fa-${o.active?o.on:o.off}`,"fas"])},null,2))}},Ue=Object.freeze(Object.defineProperty({__proto__:null,default:v},Symbol.toStringTag,{value:"Module"})),Ye={name:"WyxosImage",props:{src:{type:[File,String],required:!0},resize:{type:Object,default:null}},emits:["loaded"],data(){return{instance:null,width:0,height:0}},mounted(){this.loadImage()},unmounted(){this.instance.onload=null},methods:{loadImage(){return typeof this.src=="object"?this.loadFile():this.loadPath()},loadFile(){this.instance=new FileReader,this.instance.onload=o=>{const e=o.target.result;this.$refs.image.src=e,this.width=this.resize?this.resize.width:e.width,this.height=this.resize?this.resize.height:e.height,this.$emit("loaded")},this.instance.readAsDataURL(this.src)},loadPath(){this.instance=new Image,this.instance.onload=()=>{this.$refs.image.src=this.src,this.width=this.resize?this.resize.width:this.instance.width,this.height=this.resize?this.resize.height:this.instance.height,this.$emit("loaded")},this.instance.src=this.src}}},Qe=["width","height"];function ve(o,e,s,n,r,i){return t.openBlock(),t.createElementBlock("img",{ref:"image",src:"",alt:"",width:r.width,height:r.height},null,8,Qe)}const J=f(Ye,[["render",ve]]),Je=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"})),Ke={class:"quick-edit"},He={class:"value"},Xe=["type","readonly"],Ge=[t.createElementVNode("i",{class:"fas fa-pencil-alt"},null,-1)],Ze=["disabled"],et=[t.createElementVNode("i",{class:"fas fa-times"},null,-1)],tt=["disabled"],st={key:0,class:"fas fa-check"},ot={key:1,class:"fas fa-spinner fa-spin"},K={__name:"WyxosInlineEdit",props:{modelValue:{type:[String,Number,null],required:!0},update:{type:Function,required:!0},processing:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:e}){const s=o,n=e,r=t.ref(s.modelValue),i=t.ref(!1),a=()=>{i.value=!1,r.value=s.modelValue},l=()=>s.update(r.value).then(()=>{n("update:modelValue",r.value),i.value=!1});return(c,m)=>(t.openBlock(),t.createElementBlock("div",Ke,[i.value?t.createCommentVNode("",!0):t.renderSlot(c.$slots,"value",{key:0},()=>[t.createElementVNode("span",He,t.toDisplayString(o.modelValue),1)]),i.value?t.renderSlot(c.$slots,"field",{key:1,query:r.value},()=>[i.value?t.withDirectives((t.openBlock(),t.createElementBlock("input",{key:0,"onUpdate:modelValue":m[0]||(m[0]=b=>r.value=b),type:typeof o.modelValue=="number"?"number":"text",readonly:o.processing},null,8,Xe)),[[t.vModelDynamic,r.value]]):t.createCommentVNode("",!0)]):t.createCommentVNode("",!0),t.renderSlot(c.$slots,"actions",{enableEdit:i.value,onCancel:a,onUpdate:l},()=>[i.value?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("button",{key:0,class:"edit",onClick:m[1]||(m[1]=b=>i.value=!0)},Ge)),i.value?(t.openBlock(),t.createElementBlock("button",{key:1,class:"cancel",disabled:o.processing,onClick:m[2]||(m[2]=b=>a())},et,8,Ze)):t.createCommentVNode("",!0),i.value?(t.openBlock(),t.createElementBlock("button",{key:2,class:"save",disabled:o.processing,onClick:m[3]||(m[3]=b=>l())},[o.processing?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("i",st)),o.processing?(t.openBlock(),t.createElementBlock("i",ot)):t.createCommentVNode("",!0)],8,tt)):t.createCommentVNode("",!0)])]))}},nt=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),rt={name:"WyxosInput",props:{label:{type:String,default:""},readonly:{type:Boolean,default:!1},name:{type:String,required:!0},bag:{type:String,default:()=>"default"},type:{type:String,default:"text"},clearable:{type:Boolean,default:!1},fieldClass:{type:String,default:null},inputRootClass:{type:String,default:null},inputClass:{type:String,default:null},modelValue:{type:[String,Number,null],default:null},form:{type:g,default:null},disabled:{type:[Boolean,String],default:null},placeholder:{type:String,default:null},passwordReveal:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(){return{errors:x()}},computed:{getError(){if(this.name)return this.form?this.form.getError(this.name):this.errors.get(this.name,this.bag)}},methods:{onInput(o){this.form?this.form.clearError(this.name):this.errors.clear(this.name,this.bag),this.$emit("update:modelValue",o)}}};function it(o,e,s,n,r,i){const a=t.resolveComponent("o-input"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({class:s.fieldClass,label:s.label},i.getError),{default:t.withCtx(()=>[t.createVNode(a,{class:t.normalizeClass(s.inputClass),clearable:s.clearable,disabled:s.disabled,"model-value":s.modelValue,name:s.name,"password-reveal":s.passwordReveal,placeholder:s.placeholder,readonly:s.readonly,"root-class":s.inputRootClass,type:s.type,"onUpdate:modelValue":e[0]||(e[0]=c=>i.onInput(c))},null,8,["class","clearable","disabled","model-value","name","password-reveal","placeholder","readonly","root-class","type"])]),_:1},16,["class","label"])}const H=f(rt,[["render",it]]),at=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"})),lt={name:"WyxosListing",props:{listing:{type:C,required:!0}},computed:{allPropsAndEvents(){return{...this.listing.config,...Object.keys(this.listing.events).reduce((o,e)=>(o[`on${e.charAt(0).toUpperCase()+e.slice(1)}`]=this.listing.events[e],o),{})}}}},ct={key:0},dt={key:1},ut={key:2};function mt(o,e,s,n,r,i){const a=t.resolveComponent("o-table");return t.openBlock(),t.createBlock(a,t.normalizeProps(t.guardReactiveProps(i.allPropsAndEvents)),t.createSlots({empty:t.withCtx(()=>[s.listing.isEmpty?(t.openBlock(),t.createElementBlock("p",ct,"No records found.")):t.createCommentVNode("",!0),s.listing.isSearchEmpty?(t.openBlock(),t.createElementBlock("p",dt," No results for your query. Please adjust your search and try again. ")):t.createCommentVNode("",!0),s.listing.isFailure?(t.openBlock(),t.createElementBlock("p",ut," Failure to load the list. Try again or reload the page. ")):t.createCommentVNode("",!0)]),_:2},[t.renderList(o.$slots,(l,c)=>({name:c,fn:t.withCtx(m=>[t.renderSlot(o.$slots,c,t.normalizeProps(t.guardReactiveProps(m)))])}))]),1040)}const X=f(lt,[["render",mt]]),ht=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),ft={name:"WyxosLiveInput",props:{label:{type:String,default:""},readonly:{type:Boolean,default:!1},name:{type:String,required:!0},bag:{type:String,default:()=>"default"},type:{type:String,default:"text"},clearable:{type:Boolean,default:!1},fieldClass:{type:String,default:null},inputRootClass:{type:String,default:null},inputClass:{type:String,default:null},modelValue:{type:[String,Number,null],default:null},form:{type:g,default:null},disabled:{type:[Boolean,String],default:null},placeholder:{type:String,default:null}},emits:["update:modelValue"],setup(){return{errors:x()}},methods:{onInput(o){if(!this.name){this.$emit("update:modelValue",o);return}if(this.form)return this.form.clearError(this.name),this.form.submit(null,{formatter:()=>({field:this.name,value:o})});this.errors.clear(this.name,this.bag),this.$emit("update:modelValue",o)},getError(){if(this.name)return this.form?this.form.getError(this.name):this.errors.get(this.name)}}};function pt(o,e,s,n,r,i){const a=t.resolveComponent("o-input"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({label:s.label,class:s.fieldClass},{...i.getError()}),{default:t.withCtx(()=>[t.createVNode(a,{readonly:s.readonly,class:t.normalizeClass(s.inputClass),"root-class":s.inputRootClass,name:s.name,type:s.type,clearable:s.clearable,disabled:s.disabled,"model-value":s.modelValue,placeholder:s.placeholder,"onUpdate:modelValue":e[0]||(e[0]=c=>i.onInput(c))},null,8,["readonly","class","root-class","name","type","clearable","disabled","model-value","placeholder"])]),_:1},16,["label","class"])}const G=f(ft,[["render",pt]]),gt=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"})),yt={name:"WyxosLogout",props:{path:{type:String,default:"/logout"}},methods:{async logout(){const{data:o}=await h.post(this.path).catch(e=>{throw e.response.status===401&&(window.location.href="/"),e});window.location.href=(o==null?void 0:o.redirect)||"/"}}};function bt(o,e,s,n,r,i){return t.renderSlot(o.$slots,"default",{logout:i.logout},()=>[t.createElementVNode("button",{class:"button is-primary",onClick:e[0]||(e[0]=a=>i.logout())},"Sign out")])}const Z=f(yt,[["render",bt]]),_t=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),St=t.defineComponent({name:"WyxosProgress",props:{showValue:{type:Boolean,default:!0},modelValue:{type:Number,required:!0},max:{type:Number,required:!0},format:{type:String,default:"percent"}}}),wt=["max","value"],kt={key:0};function Ct(o,e,s,n,r,i){return t.openBlock(),t.createElementBlock(t.Fragment,null,[t.createElementVNode("progress",{max:o.max,value:o.modelValue},null,8,wt),o.showValue?(t.openBlock(),t.createElementBlock("span",kt,t.toDisplayString(o.modelValue)+" / "+t.toDisplayString(o.max),1)):t.createCommentVNode("",!0)],64)}const ee=f(St,[["render",Ct]]),Vt=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"})),xt={name:"WyxosPrompt",props:{title:{type:String,default:null},message:{type:String,default:null},confirmText:{type:String,default:null},cancelText:{type:String,default:null},loading:{type:Boolean,default:!1},callback:{type:Function,default:null}},emits:["close"],setup(){return{state:new w}},methods:{async proceed(){this.callback&&(this.state.loading(),await this.callback().catch(o=>{throw this.state.failed(),o}),this.state.loaded()),this.$emit("close",{action:!0})}}},Et={class:"flex gap-6"};function $t(o,e,s,n,r,i){const a=t.resolveComponent("wyxos-button"),l=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{active:!0,onBlur:e[2]||(e[2]=c=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createElementVNode("h2",null,t.toDisplayString(s.title),1),t.createElementVNode("p",null,t.toDisplayString(s.message),1),t.createElementVNode("div",Et,[t.createVNode(a,{disabled:n.state.isLoading,class:"button is-danger","native-type":"button",onClick:e[0]||(e[0]=c=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.cancelText),1)]),_:1},8,["disabled"]),t.createVNode(a,{loading:n.state.isLoading,class:"button","native-type":"button",onClick:e[1]||(e[1]=c=>i.proceed())},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.confirmText),1)]),_:1},8,["loading"])])]),_:1})}const O=f(xt,[["render",$t]]),Bt=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"})),Ot={name:"WyxosRemove",props:{listing:{type:C,default:null},route:{type:String,required:!0}},emits:["removed","failed"],setup(){return{destroy:g.create()}},data(){return{isVisible:!1}},methods:{async onRemove(){this.isVisible=!0},remove(){this.destroy.delete(this.route).then(()=>{this.$emit("removed"),this.listing&&this.listing.reload(),this.isVisible=!1}).catch(()=>{this.$emit("failed")})}}},Nt=t.createElementVNode("i",{class:"fas fa-trash"},null,-1),Tt={class:"content p-6"},Wt=t.createElementVNode("h3",{class:"title"},"Delete",-1),jt=t.createElementVNode("p",{class:"mb-4"}," Are you sure you want to delete this record? ",-1),Pt={class:"buttons flex gap-6 justify-end"};function qt(o,e,s,n,r,i){const a=t.resolveComponent("o-button"),l=t.resolveComponent("w-button"),c=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{class:"button is-danger",onClick:e[3]||(e[3]=m=>i.onRemove())},{default:t.withCtx(()=>[t.renderSlot(o.$slots,"button",{},()=>[Nt]),r.isVisible?(t.openBlock(),t.createBlock(t.Teleport,{key:0,to:"body"},[t.createVNode(c,{active:r.isVisible,"onUpdate:active":e[2]||(e[2]=m=>r.isVisible=m)},{default:t.withCtx(()=>[t.createElementVNode("div",Tt,[t.renderSlot(o.$slots,"title",{},()=>[Wt]),t.renderSlot(o.$slots,"message",{},()=>[jt]),t.createElementVNode("div",Pt,[t.createVNode(a,{class:"button is-secondary",onClick:e[0]||(e[0]=m=>r.isVisible=!1)},{default:t.withCtx(()=>[t.createTextVNode("Cancel ")]),_:1}),t.createVNode(l,{loading:n.destroy.isSubmitting,class:"button is-danger",onClick:e[1]||(e[1]=m=>i.remove())},{default:t.withCtx(()=>[t.renderSlot(o.$slots,"confirm",{},()=>[t.createTextVNode("Confirm")])]),_:3},8,["loading"])])])]),_:3},8,["active"])])):t.createCommentVNode("",!0)]),_:3})}const te=f(Ot,[["render",qt]]),Lt=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"})),Ft={name:"WyxosSelect",props:{label:{type:String,default:null},placeholder:{type:String,default:null},disabled:{type:Boolean,default:null},name:{type:String,default:null},modelValue:{type:[null,String,Number],required:!0},form:{type:g,default:null},items:{type:Array,default:null}},emits:["update:modelValue"],methods:{updateValue(o){var e;(e=this.form)==null||e.clearError(this.name),this.$emit("update:modelValue",o)}}},Rt=["value"];function At(o,e,s,n,r,i){var c;const a=t.resolveComponent("o-select"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({label:s.label},(c=s.form)==null?void 0:c.getError(s.name)),{default:t.withCtx(()=>[t.createVNode(a,{disabled:s.disabled,"model-value":s.modelValue,name:s.name,placeholder:s.placeholder,"root-class":"w-full","select-class":"w-full","onUpdate:modelValue":e[0]||(e[0]=m=>i.updateValue(m))},{default:t.withCtx(()=>[t.renderSlot(o.$slots,"default",{},()=>[s.items?(t.openBlock(!0),t.createElementBlock(t.Fragment,{key:0},t.renderList(s.items,m=>(t.openBlock(),t.createElementBlock("option",{key:m.value,value:m.value},t.toDisplayString(m.label),9,Rt))),128)):t.createCommentVNode("",!0)])]),_:3},8,["disabled","model-value","name","placeholder"])]),_:3},16,["label"])}const se=f(Ft,[["render",At]]),Mt=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),It={name:"WyxosSessionExpired",emits:["close"],setup(){return{login:g.create({email:null,password:null})}},data(){return{user:null,propertiesCount:0,organisations:[]}},methods:{async proceed(){await this.login.submit("/login"),this.$emit("close",{action:!0})},onLogout(){window.location.href="/"}}},zt={class:"bg-white p-6"},Dt=t.createElementVNode("h2",{class:"title"},"Session Expired",-1),Ut=t.createElementVNode("p",{class:"mb-6"}," It looks like you've been away for a bit. For your security, please re-enter your credentials to continue. ",-1),Yt={class:"buttons"};function Qt(o,e,s,n,r,i){const a=t.resolveComponent("wyxos-input"),l=t.resolveComponent("w-button"),c=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(c,{active:!0},{default:t.withCtx(()=>[t.createElementVNode("div",zt,[Dt,Ut,t.createElementVNode("form",{onSubmit:e[3]||(e[3]=t.withModifiers((...m)=>i.proceed&&i.proceed(...m),["prevent"]))},[t.createVNode(a,{modelValue:n.login.email,"onUpdate:modelValue":e[0]||(e[0]=m=>n.login.email=m),name:"email",label:"Email"},null,8,["modelValue"]),t.createVNode(a,{modelValue:n.login.password,"onUpdate:modelValue":e[1]||(e[1]=m=>n.login.password=m),name:"password",label:"Password",type:"password"},null,8,["modelValue"]),t.createElementVNode("div",Yt,[t.createVNode(l,{class:"button is-danger",disabled:n.login.isSubmitting,onClick:e[2]||(e[2]=m=>i.onLogout())},{default:t.withCtx(()=>[t.createTextVNode(" Logout ")]),_:1},8,["disabled"]),t.createVNode(l,{class:"button is-primary","native-type":"submit",loading:n.login.isSubmitting},{default:t.withCtx(()=>[t.createTextVNode(" Login ")]),_:1},8,["loading"])])],32)])]),_:1})}const N=f(It,[["render",Qt]]),vt=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"})),Jt={name:"WyxosSubmit",props:{form:{type:g,required:!0},labels:{type:Object,default(){return{submit:"Submit",submitting:"Processing",submitted:"Complete",failed:"Retry"}}}},data(){return{mergedLabels:{submit:"Submit",submitting:"Processing",submitted:"Complete",failed:"Retry"}}},watch:{labels:{deep:!0,handler(o){this.mergedLabels={...this.mergedLabels,...o}}}},created(){this.mergedLabels={...this.mergedLabels,...this.labels}}},Kt={key:0},Ht={key:1},Xt=t.createElementVNode("i",{class:"fas fa-spinner fa-spin"},null,-1),Gt={key:2},Zt={key:3};function es(o,e,s,n,r,i){const a=t.resolveComponent("o-button");return t.openBlock(),t.createBlock(a,{disabled:!!(s.form.isSubmitting||s.form.isSubmitted),"native-type":"submit"},{default:t.withCtx(()=>[!s.form.isSubmitted&&!s.form.isSubmitting&&!s.form.isSubmitFailed?(t.openBlock(),t.createElementBlock("span",Kt,t.toDisplayString(r.mergedLabels.submit),1)):t.createCommentVNode("",!0),s.form.isSubmitting?(t.openBlock(),t.createElementBlock("span",Ht,[t.createTextVNode(t.toDisplayString(r.mergedLabels.submitting)+" ",1),Xt])):t.createCommentVNode("",!0),s.form.isSubmitted?(t.openBlock(),t.createElementBlock("span",Gt,t.toDisplayString(r.mergedLabels.submitted),1)):t.createCommentVNode("",!0),s.form.isSubmitFailed?(t.openBlock(),t.createElementBlock("span",Zt,t.toDisplayString(r.mergedLabels.failed),1)):t.createCommentVNode("",!0)]),_:1},8,["disabled"])}const oe=f(Jt,[["render",es]]),ts=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),ne={__name:"WyxosTab",props:{active:{type:String,required:!0},hashKey:{type:String,default:()=>`tab-${Math.random().toString(36).slice(2,11)}`},responsiveResolution:{type:Number,default:768}},emits:["update:active"],setup(o,{emit:e}){const s=o,n=e,r=()=>{const p=window.location.hash.replace("#",""),_=new URLSearchParams(p);return Object.fromEntries(_.entries())},i=(p,_)=>{const L=window.location.hash.replace("#",""),S=new URLSearchParams(L);S.set(p,_),window.location.hash=S.toString()},a=t.ref(r()[s.hashKey]||s.active),l=t.ref(!1),c=p=>l.value?!0:p===a.value,m=()=>{l.value=window.innerWidth<=s.responsiveResolution},b=p=>{a.value=p,n("update:active",p),i(s.hashKey,p)};return t.onMounted(()=>{window.addEventListener("hashchange",()=>{const p=r();p[s.hashKey]&&(a.value=p[s.hashKey])}),m(),window.addEventListener("resize",m)}),t.onUnmounted(()=>{window.removeEventListener("hashchange",()=>{}),window.removeEventListener("resize",m)}),(p,_)=>(t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(p.$slots,"navigation",{isActive:c,setActive:b},()=>[t.createTextVNode(" Fill in navigation content here ")]),t.renderSlot(p.$slots,"content",{isActive:c},()=>[t.createTextVNode(" Fill in content here")])]))}},ss=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));class B{constructor(e={}){u(this,"state",new w);u(this,"result",t.ref([]));u(this,"value",t.ref(null));u(this,"timeout",null);u(this,"options",{url:null,payload:null,field:null});Object.assign(this.options,e)}get getConfig(){return{data:this.result.value,field:this.options.field,modelValue:this.value.value}}static create(e){return new B(e)}getEvents({searchPayloadFormatter:e=null}={}){return{"update:model-value":s=>(this.value.value=s,this.search(e))}}search(e){const s={value:this.value.value},n=e?e(s):s;return this.customSearch({payload:n})}async customSearch({url:e,payload:s}){this.timeout&&(this.controller.abort(),clearTimeout(this.timeout)),this.controller=new AbortController,this.timeout=setTimeout(async()=>{this.state.loading(),this.reset();const n=e||this.options.url,{data:r}=await h.post(`${n}/search`,s||this.options.payload,{signal:this.controller.signal}).catch(i=>{throw this.state.failed(),i});this.result.value=r.result,this.state.loaded()},500)}async restore(e,s){this.state.loading(),this.reset();const n=e||this.options.url,{data:r}=await h.post(`${n}/restore`,s||this.options.payload).catch(i=>{throw this.state.failed(),i});return this.state.loaded(),r}reset(){this.result.value=[]}}const os={name:"WyxosTags",props:{path:{type:String,required:!0},modelValue:{type:Array,required:!0},formatter:{type:Function,required:!0},excludeFormatter:{type:Function,default:null},restoreFormatter:{type:Function,default:o=>o},payloadFormatter:{type:Function,default:o=>o},openOnFocus:{type:Boolean,default:!1}},emits:["update:modelValue","update:query","change"],setup(){return{search:B.create()}},data(){return{query:[],isInternalChange:!1}},watch:{modelValue:{handler:async function(o,e){this.isInternalChange?this.isInternalChange=!1:JSON.stringify(o)!==JSON.stringify(e)&&this.restore()},deep:!0,immediate:!1}},async mounted(){this.restore()},methods:{async restore(){if(this.modelValue&&this.modelValue.length){this.isInternalChange=!0;const{result:o}=await this.search.restore(this.path,this.restoreFormatter({values:this.modelValue}));this.query=o,this.$emit("update:modelValue",this.query.map(e=>this.formatter(e))),this.$emit("update:query",this.query)}},onTagSearch(o){return this.search.customSearch({url:this.path,payload:this.payloadFormatter({value:o,exclude:this.query.map(e=>this.excludeFormatter(e)).filter(Boolean)})})},onTagAdded(){this.isInternalChange=!0;const o=this.query.map(e=>this.formatter(e));this.$emit("update:modelValue",o),this.$emit("update:query",this.query),this.$emit("change")},onTagRemoved(){this.isInternalChange=!0;const o=this.query.map(e=>this.formatter(e));this.$emit("update:modelValue",o),this.$emit("update:query",this.query),this.$emit("change")},reset(){this.isInternalChange=!0,this.query=[],this.$emit("update:modelValue",this.query),this.$emit("update:query",this.query)},addItem(){this.$refs.tagInput.addItem()},focus(){this.openOnFocus&&this.onTagSearch("")}}};function ns(o,e,s,n,r,i){const a=t.resolveComponent("o-taginput");return t.openBlock(),t.createBlock(a,t.mergeProps({ref:"tagInput",modelValue:r.query,"onUpdate:modelValue":e[0]||(e[0]=l=>r.query=l),data:n.search.result.value,"open-on-focus":s.openOnFocus,"allow-autocomplete":""},o.$attrs,{onAdd:e[1]||(e[1]=l=>i.onTagAdded(l)),onFocus:e[2]||(e[2]=l=>i.onTagSearch("")),onRemove:e[3]||(e[3]=l=>i.onTagRemoved(l)),onTyping:e[4]||(e[4]=l=>i.onTagSearch(l))}),null,16,["modelValue","data","open-on-focus"])}const re=f(os,[["render",ns]]),rs=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"})),is={name:"WyxosTokenExpired",emits:["close"],methods:{async proceed(){this.$emit("close",{action:!0})}}},as={class:"bg-white p-6"},ls=t.createElementVNode("h2",{class:"title"},"Session expired",-1),cs=t.createElementVNode("p",{class:"mb-6"}," Your tab has been idle for a while. We've refreshed your session for you. If you encountered an error after performing an action, please close this prompt and try again. ",-1),ds={class:"buttons"};function us(o,e,s,n,r,i){const a=t.resolveComponent("w-button"),l=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{active:!0},{default:t.withCtx(()=>[t.createElementVNode("div",as,[ls,cs,t.createElementVNode("div",ds,[t.createVNode(a,{class:"button is-primary",onClick:e[0]||(e[0]=c=>o.$emit("close",{action:!0}))},{default:t.withCtx(()=>[t.createTextVNode(" Confirm ")]),_:1})])])]),_:1})}const T=f(is,[["render",us]]),ms=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"})),W={UK_TIME:"DD/MM/YYYY HH:mm:ss",UK:"DD/MM/YYYY",DB_TIME:"YYYY-MM-DD HH:mm:ss",DB:"YYYY-MM-DD"};class ie{constructor(e){u(this,"date",null);u(this,"empty","");this.date=e}static load(e,s=""){return new this(e,s)}format(e,s=W.UK,n=""){return e?V(e).format(s):n||this.empty}render(e=W.UK,s=""){return this.format(this.date,e,s)}}u(ie,"FORMATS",W);class hs{constructor(e){this.data=new FormData,this.form=e,this.copy=Object.assign({},JSON.parse(JSON.stringify(e)))}static build(e,s){return new this(e).files(s).get()}static callback(e){return s=>this.build(s,e).get()}files(e){return e.forEach(s=>{typeof s=="object"?(this.data.append(s.name,s.value),delete this.copy[s.name]):this.form[s]&&(this.data.append(s,this.form[s]),delete this.copy[s])}),this}add(e,s){return this.data.append(e,s),this}get(){return this.data.append("payload",JSON.stringify(this.copy)),this.data}}class j{constructor(){u(this,"state",t.ref(!1))}get isVisible(){return this.state}static create(){return new j}show(){this.state=!0}hide(){this.state=!1}}class fs{static create(e,s=null,n=null){return s=s||e,{value:e,label:s}}}class ps{constructor(){u(this,"structure",{});u(this,"query",t.reactive({items:[],perPage:0,total:0,isLoading:!1,isLoaded:!1,isFilterActive:!1}));u(this,"params",t.reactive({page:1}));u(this,"router",null)}static create(e,s={},n={},r){n=Object.assign({base:"/api/admin",route:`${e}.index`},n);const i=n.base,a={route:n.route,index:n.index||`${i}/${e}/index`,destroy:`${i}/${e}/destroy`},l=new this;return l.options=n,l.structure=s,l.params=Object.assign(l.params,s),l.router=r,l.urls=a,l}async fetch(e){this.query.isLoading=!0,this.query.isLoaded=!1;const{data:s}=await h.get(e||this.urls.index,{params:this.params}).catch(n=>{throw this.query.isLoading=!1,n});return await this.router.push({name:this.urls.route,query:this.params}),this.query.isLoading=!1,this.query.isLoaded=!0,s}async load(e){const s=await this.fetch(e);return Object.assign(this.query,s.query,{items:s.query.items.map(n=>({...n,isProcessing:!1}))}),s}onPageChange(e){return this.params.page=e,this.load()}async action(e,{row:s,index:n,remove:r,method:i},a={}){s.isProcessing=!0;const l={id:s.id,...a};if(i==="delete"){const{data:c}=await h.delete(e,{data:l}).catch(m=>{throw s.isProcessing=!1,m});s.isProcessing=!1,c.row&&Object.assign(s,c.row)}else{const{data:c}=await h.post(e,l).catch(m=>{throw s.isProcessing=!1,m});s.isProcessing=!1,c.row&&Object.assign(s,c.row)}if(r){const c=await this.fetch();if(this.query.items.splice(n,1),!c.query.items.length){this.params.page--,await this.load();return}this.query.items.length<c.query.items.length&&this.query.items.push(c.query.items[c.query.items.length-1])}}destroy(e,s){return this.action(this.urls.destroy,{...e,remove:!0},s)}async resetFilter(e=null){Object.assign(this.params,this.structure),this.query.isFilterActive=!1,await this.load(e)}}class gs{constructor(e){u(this,"current",t.ref(null));u(this,"history",t.ref([]));u(this,"flow",[]);this.current.value=e}is(e){return this.current.value===e}isAny(...e){return!!e.includes(this.current.value)}setFlow(e){this.flow=e}next(){const e=this.flow.findIndex(n=>n===this.getCurrent()),s=this.flow[e+1];if(s){this.set(s);return}throw Error(`No step defined after ${this.getCurrent()}`)}set(e){this.current.value=e,this.history.value.push(e)}previous(){this.history.value.pop(),this.current.value=this.history.value[this.history.value.length-1]}getCurrent(){return this.current.value}assign(e){Object.assign(this,e)}}class P{constructor(e){u(this,"attributes",t.reactive({name:null}));u(this,"callbacks",{});this.attributes.name=e}is(e){return this.attributes.name===e}onChange(e){this.callbacks=e}activeClass(e,s){return{class:this.is(e)?s:[]}}set(e){this.attributes.name=e,this.callbacks[e]&&this.callbacks[e]()}assign(e){Object.assign(this,e)}static create(e){return new P(e)}}class ys{constructor(){u(this,"attributes",t.reactive({user:null}));u(this,"state",new w);return new Proxy(this,{get(e,s,n){return Reflect.has(e,s)?Reflect.get(e,s,n):s in e.attributes?e.attributes[s]:null},set(e,s,n,r){return!Reflect.has(e,s)&&!(s in e.attributes)?(Reflect.set(e,s,n,r),!0):s in e.attributes?(e.attributes[s]=n,!0):Reflect.set(e,s,n,r)}})}get isLoading(){return this.state.isLoading}get isLoaded(){return this.state.isLoaded}get isFailure(){return this.state.isFailure}get isAuthenticated(){return!!this.attributes.user}async load(){this.loading(),await h.get("/sanctum/csrf-cookie").catch(s=>{throw this.failed(),s});const{data:e}=await h.get("/api/user");if(!("user"in e))throw Error("Instance of user is not defined.");Object.keys(e).forEach(s=>{this.attributes[s]=e[s]}),this.loaded()}loading(){return this.state.loading()}loaded(){return this.state.loaded()}failed(){return this.state.failed()}reset(){this.attributes=t.reactive({user:null}),this.state.reset()}}const bs=new ys;async function _s(o={}){return(await $.useOruga().modal.open({component:O,props:Object.assign({title:"Confirm",message:"Are you sure you want proceed?",confirmText:"Yes",cancelText:"Cancel"},o),trapFocus:!0}).promise).action}async function ae(o,e){var i,a,l,c,m,b;if((o==null?void 0:o.code)==="ERR_CANCELED")return Promise.reject(o);const s={401:"Authentication required. Please reload the page and sign in.",403:"You do not have permission to perform this action.",404:"The page or action you are looking for could not be found.",419:"Your session has likely expired. Try again or reload the page.",422:"The action attempted was invalid. Please review your input and try again.",500:"An unexpected error has occurred. This issue has been reported.",503:"The site is currently under maintenance. Please try again later."};Object.assign(s,(e==null?void 0:e.messages)||{});const n=s[(i=o.response)==null?void 0:i.status]||s[500],r=$.useOruga();if(r.notification.open({message:n,duration:1e3*5,variant:"danger",position:"bottom-right",closable:!0}),((a=o.response)==null?void 0:a.status)===419){r.modal.open({component:((l=e.components)==null?void 0:l.TokenExpired)||T,trapFocus:!0,closable:!1});const _=(await h.get("/heartbeat")).data.csrfToken;h.defaults.headers.common["X-CSRF-TOKEN"]=_}if(((c=o.response)==null?void 0:c.status)===401&&r.modal.open({component:((m=e.components)==null?void 0:m.SessionExpired)||N,trapFocus:!0,closable:!1}),((b=o.response)==null?void 0:b.status)===422){const p=setInterval(()=>{const _=document.querySelectorAll(".o-field__message-danger, .wyxos-error"),L=k=>{const F=k.getBoundingClientRect(),E=window.getComputedStyle(k);return F.width>0&&F.height>0&&E.display!=="none"&&E.visibility!=="hidden"&&E.opacity!=="0"},S=Array.from(_).find(L);if(S){clearInterval(p);let k;if(S.classList.contains("o-field__message-danger")?k=S.closest(".o-field"):S.classList.contains("wyxos-error")&&(k=S.closest("label")),k){const E=k.getBoundingClientRect().top+window.scrollY-10;window.scrollTo({top:E,behavior:"smooth"})}else console.error("Could not determine the scroll target.")}},100)}return Promise.reject(o)}function Ss(o){$.useOruga().notification.open({message:o||"Action successful.",duration:2500,variant:"success",position:"bottom-right",closable:!0})}function ws(o){h.interceptors.response.use(null,e=>ae(e,o))}const le=Object.assign({"./components/WyxosAccordion.vue":de,"./components/WyxosAction.vue":fe,"./components/WyxosButton.vue":we,"./components/WyxosCollection.vue":xe,"./components/WyxosConfirm.vue":We,"./components/WyxosDatepicker.vue":qe,"./components/WyxosError.vue":Me,"./components/WyxosForm.vue":De,"./components/WyxosIcon.vue":Ue,"./components/WyxosImage.vue":Je,"./components/WyxosInlineEdit.vue":nt,"./components/WyxosInput.vue":at,"./components/WyxosListing.vue":ht,"./components/WyxosLiveInput.vue":gt,"./components/WyxosLogout.vue":_t,"./components/WyxosProgress.vue":Vt,"./components/WyxosPrompt.vue":Bt,"./components/WyxosRemove.vue":Lt,"./components/WyxosSelect.vue":Mt,"./components/WyxosSessionExpired.vue":vt,"./components/WyxosSubmit.vue":ts,"./components/WyxosTab.vue":ss,"./components/WyxosTags.vue":rs,"./components/WyxosTokenExpired.vue":ms}),q={},ks={install:(o,e={})=>{e={vision:{},oruga:{},use:{oruga:!0},...e},e.use.oruga&&o.use($,e.oruga),Object.keys(le).forEach(s=>{const n=le[s];if(n&&n.default){const r=n.default,i=r.name;if(i)o.component(i,r),o.component(i.replace("Wyxos","W"),r),q[i]=r;else{const a=s.split("/").pop().split(".")[0];o.component(a,r),o.component(a.replace("Wyxos","W"),r),q[a]=r}}else console.error(`Could not load component from '${s}'`)}),o.config.globalProperties.$v={to:(s,n)=>({name:s,params:n})},ws(e)},...q};d.Action=A,d.DateRender=ie,d.FileRequest=hs,d.FormBuilder=g,d.Listing=C,d.LoadState=w,d.Modal=j,d.Option=fs,d.ResourceList=ps,d.Search=B,d.Steps=gs,d.Tab=P,d.WyxosAccordion=R,d.WyxosAction=M,d.WyxosButton=I,d.WyxosCollection=z,d.WyxosConfirm=D,d.WyxosDatepicker=U,d.WyxosError=Y,d.WyxosForm=Q,d.WyxosIcon=v,d.WyxosImage=J,d.WyxosInlineEdit=K,d.WyxosInput=H,d.WyxosListing=X,d.WyxosLiveInput=G,d.WyxosLogout=Z,d.WyxosProgress=ee,d.WyxosPrompt=O,d.WyxosRemove=te,d.WyxosSelect=se,d.WyxosSessionExpired=N,d.WyxosSubmit=oe,d.WyxosTab=ne,d.WyxosTags=re,d.WyxosTokenExpired=T,d.auth=bs,d.confirm=_s,d.default=ks,d.errorHandler=ae,d.success=Ss,d.useFormErrors=x,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=vision.umd.cjs.map
