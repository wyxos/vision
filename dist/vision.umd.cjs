(function(c,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("axios"),require("moment"),require("@oruga-ui/oruga-next")):typeof define=="function"&&define.amd?define(["exports","vue","axios","moment","@oruga-ui/oruga-next"],t):(c=typeof globalThis<"u"?globalThis:c||self,t(c.Vision={},c.Vue,c.axios,c.moment,c.Oruga))})(this,function(c,t,f,V,B){"use strict";var ms=Object.defineProperty;var fs=(c,t,f)=>t in c?ms(c,t,{enumerable:!0,configurable:!0,writable:!0,value:f}):c[t]=f;var m=(c,t,f)=>fs(c,typeof t!="symbol"?t+"":t,f);const de={class:"wyxos-accordion"},R={__name:"WyxosAccordion",props:{active:{type:Boolean,required:!1}},setup(o){const e=o,s=t.ref(!1),n=()=>{s.value=!s.value};return t.onMounted(()=>{s.value=e.active}),(r,i)=>(t.openBlock(),t.createElementBlock("div",de,[t.renderSlot(r.$slots,"header",{isOpen:s.value,toggle:n}),s.value?t.renderSlot(r.$slots,"body",{key:0}):t.createCommentVNode("",!0)]))}},ce=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));class A{constructor(e){m(this,"type","switch");m(this,"field","");m(this,"url","");m(this,"processing",t.ref(null));m(this,"target",t.ref(null));m(this,"beforeCallback",null);m(this,"afterCallback",null);m(this,"error",null);this.url=e}static create(e){return new this(e)}async patch(e,s){var n,r;if(this.target.value=e,this.processing.value=e.id,this.beforeCallback&&this.beforeCallback(e,s)===!1){this.processing.value=null,this.target.value=null;return}await new Promise(i=>setTimeout(i,1e3));try{const i=typeof this.url=="function"?this.url(e):this.url;return this.processing.value=null,this.target.value=null,await f.patch(i,s).then(a=>(this.processing.value=null,this.target.value=null,this.afterCallback&&this.afterCallback(a),a))}catch(i){this.processing.value=null,this.target.value=null,this.error=((r=(n=i.response)==null?void 0:n.data)==null?void 0:r.message)||i.message}}async delete(e){var s,n;if(this.target.value=e,this.processing.value=e.id,this.beforeCallback&&this.beforeCallback(e)===!1){this.processing.value=null,this.target.value=null;return}await new Promise(r=>setTimeout(r,1e3));try{const r=typeof this.url=="function"?this.url(e):this.url;return f.delete(r).then(i=>(this.processing.value=null,this.target.value=null,this.afterCallback&&this.afterCallback(i),i))}catch(r){return this.error=((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||r.message,this.processing.value=null,this.target.value=null,r}}before(e){return this.beforeCallback=e,this}after(e){return this.afterCallback=e,this}isProcessing(e){return this.processing.value===e.id}}const ue=["disabled"],me={key:0,class:"fas fa-spinner fa-spin"},fe={key:1,class:t.normalizeClass("fas fa-trash")},M={__name:"WyxosAction",props:{action:{type:A,required:!0},row:{type:Object,required:!0}},setup(o){return(e,s)=>(t.openBlock(),t.createElementBlock("button",{disabled:o.action.isProcessing(o.row),class:"bg-red-500 text-white",onClick:s[0]||(s[0]=n=>o.action.delete(o.row))},[o.action.isProcessing(o.row)?(t.openBlock(),t.createElementBlock("i",me)):(t.openBlock(),t.createElementBlock("i",fe))],8,ue))}},he=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"})),b=t.reactive({default:[]});function x(){return{createBag(o){b[o]||(b[o]=[])},set(o,e="default"){if(!(o.response&&o.response.data&&o.response.data.errors))throw o;b[e]=Object.keys(o.response.data.errors).map(n=>({key:n,message:o.response.data.errors[n][0]}))},has(o,e="default"){return b[e].some(s=>s.key===o)},setOne(o,e,s="default"){const n=b[s];if(!n){b[s]=[{key:o,message:e}];return}const r=n.findIndex(i=>i.key===o);if(r!==-1){n[r].message=e;return}n.push({key:o,message:e})},get(o,e="default"){const s=b[e];if(!s)return{message:"",variant:""};const n=s.find(r=>Array.isArray(o)?o.includes(r.key):r.key===o);return n?{message:n.message,variant:"danger"}:{message:"",variant:""}},clear(o=null,e="default"){if(o){const s=b[e];if(!s){console.warn(`Bag ${e} is not defined.`);return}const n=s.findIndex(r=>r.key===o);n!==-1&&s.splice(n,1);return}b[e]=[]},all(o="default"){return b[o]}}}class y{constructor(e={}){m(this,"submitUrl",null);m(this,"loadUrl",null);m(this,"original",{});m(this,"form",t.reactive({}));m(this,"abortSubmitController",null);m(this,"abortLoadController",null);m(this,"submitState",t.ref(""));m(this,"loadState",t.ref(""));m(this,"errors",x());m(this,"resetAfterSubmitFlag",!1);m(this,"callbacks",{submit:null,load:null,success:null,failure:null,formatter:null});return this.setAttributes(e),new Proxy(this,{get(s,n,r){if(Reflect.has(s,n))return Reflect.get(s,n,r);if(Reflect.has(s.form,n)){const i=n.split(".");if(i.length>1){let a=s.form;for(let l=0;l<i.length;l++)a=a[i[l]];return a??void 0}return Reflect.get(s.form,n)}},set(s,n,r,i){if(Reflect.has(s,n))return Reflect.set(s,n,r,i);if(Reflect.has(s.form,n)){const a=n.split(".");if(a.length>1){let l=s.form;for(let d=0;d<a.length-1;d++)a[d]in l||(l[a[d]]={}),l=l[a[d]];return l[a[a.length-1]]===void 0?!1:(l[a[a.length-1]]=r,!0)}return Reflect.set(s.form,n,r)}return!1}})}get isDirty(){const e=s=>Array.isArray(s)?s.map(e):s&&typeof s=="object"?Object.keys(s).sort().reduce((n,r)=>(n[r]=e(s[r]),n),{}):s;return JSON.stringify(e(this.original))!==JSON.stringify(e(this.form))}get isSubmitting(){return this.submitState.value==="loading"}get isSubmitted(){return this.submitState.value==="loaded"}get isSubmitFailed(){return this.submitState.value==="failed"}static create(e){return new this(e)}resetAfterSubmit(e=!0){return this.resetAfterSubmitFlag=e,this}setAttributes(e){return this.original=e,Object.assign(this.form,this.original),this}submitAt(e){return this.submitUrl=e,this}async submit(){this.submitting(),this.clearErrors();const e={};this.abortSubmitController&&this.abortSubmitController.abort(),this.abortSubmitController=new AbortController,e.signal=this.abortSubmitController.signal,await new Promise(n=>setTimeout(n,1e3));const s=this.callbacks.formatter?this.callbacks.formatter(this.form):this.form;return f.post(this.submitUrl,s,e).then(n=>(this.submitted(),this.resetAfterSubmitFlag&&this.setAttributes(this.original),this.callbacks.success?this.callbacks.success(n.data):n.data)).catch(n=>(this.submitFailed(),this.errors.set(n),Promise.reject(n)))}load(){this.loading();const e={};return this.abortLoadController&&this.abortLoadController.abort(),this.abortLoadController=new AbortController,e.signal=this.abortLoadController.signal,f.get(this.loadUrl,e).then(s=>(this.loaded(),s.data.form&&this.setAttributes(s.data.form),s.data)).catch(s=>(this.loadFailed(),Promise.reject(s)))}submitting(){this.submitState.value="loading"}submitted(){this.submitState.value="loaded"}submitFailed(){this.submitState.value="failed"}loading(){this.loadState.value="loading"}loaded(){this.loadState.value="loaded"}loadFailed(){this.loadState.value="failed"}formatter(e){return this.callbacks.formatter=e,this}loadFrom(e){return this.loadUrl=e,this}getError(e){return this.errors.get(e)}hasError(e){return this.errors.has(e)}clearError(e){this.errors.clear(e)}clearErrors(){this.errors.clear()}getErrors(){return this.errors.all()}onSuccess(e){return this.callbacks.success=e,this}onFailure(e){return this.callbacks.failure=e,this}toJson(){return JSON.parse(JSON.stringify(this.form))}}const h=(o,e)=>{const s=o.__vccOpts||o;for(const[n,r]of e)s[n]=r;return s},pe={name:"WyxosButton",props:{form:{type:y,default:null},button:{type:String,default:"submit"}}},ge=["disabled","type"],ye={key:0},be={key:1};function _e(o,e,s,n,r,i){return t.openBlock(),t.createElementBlock("button",{disabled:s.form.isSubmitting,type:s.button},[t.renderSlot(o.$slots,"default",{},()=>[s.form.isSubmitting?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("span",ye,"Submit")),s.form.isSubmitting?(t.openBlock(),t.createElementBlock("span",be,"Processing")):t.createCommentVNode("",!0)]),s.form.isSubmitting?t.renderSlot(o.$slots,"icon",{key:0},()=>[e[0]||(e[0]=t.createElementVNode("i",{class:"fas fa-spinner fa-spin ml-4"},null,-1))]):t.createCommentVNode("",!0)],8,ge)}const I=h(pe,[["render",_e]]),Se=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"})),ke={name:"WyxosCollection",props:{modelValue:{required:!0,type:Array}},emits:["update:modelValue"],data(){return{items:[]}},mounted(){this.items=this.modelValue},methods:{add(o){this.items.push(o),this.$emit("update:modelValue",this.items)},remove(o){this.items.splice(o,1),this.$emit("update:modelValue",this.items)}}};function we(o,e,s,n,r,i){return t.renderSlot(o.$slots,"default",t.normalizeProps(t.guardReactiveProps({add:i.add,remove:i.remove,items:r.items})),()=>[e[0]||(e[0]=t.createElementVNode("ul",null,[t.createElementVNode("li")],-1))])}const z=h(ke,[["render",we]]),Ce=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));class k{constructor(){m(this,"state",t.reactive({isLoading:!1,isLoaded:!1,isFailure:!1}))}get isLoading(){return this.state.isLoading}get isLoaded(){return this.state.isLoaded}get isFailure(){return this.state.isFailure}isState(e){return this.state[e]}loading(){Object.assign(this.state,{isLoading:!0,isLoaded:!1,isFailure:!1})}loaded(){Object.assign(this.state,{isLoading:!1,isLoaded:!0,isFailure:!1})}failed(){Object.assign(this.state,{isLoading:!1,isLoaded:!1,isFailure:!0})}reset(){Object.assign(this.state,{isLoading:!1,isLoaded:!1,isFailure:!1})}static create(){return new k}}const Ve={name:"WyxosConfirm",props:{title:{type:String,default:"Title"},message:{type:String,default:""},confirmText:{type:String,default:""},confirmType:{type:String,default:""},cancelText:{type:String,default:""},loading:{type:Boolean},callback:{type:Function,default:null}},emits:["close"],setup(){return{state:new k}},methods:{async proceed(){this.callback&&(this.state.loading(),await this.callback().catch(o=>{throw this.state.failed(),o}),this.state.loaded()),this.$emit("close",{action:!0})}}},xe={class:"bg-white p-6"},Ee={class:"title"},Be={class:"mb-6"},$e={class:"buttons",role:"group"};function Oe(o,e,s,n,r,i){const a=t.resolveComponent("wyxos-button"),l=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{active:!0,onClose:e[2]||(e[2]=d=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createElementVNode("section",xe,[t.createElementVNode("article",null,[t.createElementVNode("header",null,[t.createElementVNode("h3",Ee,t.toDisplayString(s.title),1)]),t.createElementVNode("p",Be,t.toDisplayString(s.message),1),t.createElementVNode("footer",$e,[t.createVNode(a,{disabled:n.state.isLoading,class:"button secondary","native-type":"button",onClick:e[0]||(e[0]=d=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.cancelText),1)]),_:1},8,["disabled"]),t.createVNode(a,{class:t.normalizeClass([{[s.confirmType]:!0},"button"]),loading:n.state.isLoading,"native-type":"button",onClick:e[1]||(e[1]=d=>i.proceed())},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.confirmText),1)]),_:1},8,["class","loading"])])])])]),_:1})}const D=h(Ve,[["render",Oe]]),Ne=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"})),Te={name:"WyxosDatepicker",props:{modelValue:{required:!0,type:[null,String]},displayFormat:{type:String,default:"DD/MM/YYYY"},submitFormat:{type:String,default:"YYYY-MM-DD"},label:{type:String,default:null},name:{type:String,default:null},form:{type:y,default:null},options:{type:Object,default(){return{}}}},emits:["update:modelValue"],data(){return{query:null}},computed:{mergedOptions(){return{enableTimePicker:!1,autoApply:!0,...this.options}}},watch:{modelValue:{handler(o){this.query=o?V(o,this.submitFormat)._d:null},immediate:!0,deep:!0}},mounted(){this.modelValue&&(this.query=V(this.modelValue,this.submitFormat)._d)},methods:{dateFormatter(o){return o?V(o).format(this.displayFormat):null},updateQuery(){var o;this.$emit("update:modelValue",this.query?V(this.query).format(this.submitFormat):null),(o=this.form)==null||o.clearError(this.name)}}};function Pe(o,e,s,n,r,i){var d;const a=t.resolveComponent("o-datepicker"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({label:s.label},(d=s.form)==null?void 0:d.getError(s.name)),{default:t.withCtx(()=>[t.createVNode(a,t.mergeProps({modelValue:r.query,"onUpdate:modelValue":e[0]||(e[0]=u=>r.query=u),"date-formatter":i.dateFormatter,"trap-focus":""},s.options,{"onUpdate:modelValue":i.updateQuery}),null,16,["modelValue","date-formatter","onUpdate:modelValue"])]),_:1},16,["label"])}const U=h(Te,[["render",Pe]]),We=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"})),je=t.defineComponent({name:"WyxosError",props:{form:{type:y,default:null},name:{type:String,required:!0}},setup(){return{errors:x()}}}),qe={key:0,class:"wyxos-error"},Fe={key:1,class:"wyxos-error"};function Le(o,e,s,n,r,i){var a,l;return(a=o.form)!=null&&a.getError(o.name).message?(t.openBlock(),t.createElementBlock("span",qe,t.toDisplayString(o.form.getError(o.name).message),1)):(l=o.errors.get(o.name))!=null&&l.message?(t.openBlock(),t.createElementBlock("span",Fe,t.toDisplayString(o.errors.get(o.name).message),1)):t.createCommentVNode("",!0)}const Y=h(je,[["render",Le]]),Re=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));class Ae{constructor(e){m(this,"applied",{});this.original=e,this.query=t.reactive({page:1,perPage:10,...e})}render(){return this.applied}reset(){this.query=t.reactive({page:1,perPage:10,...this.original})}clear(){}}class C{constructor(e){m(this,"loadUrl","");m(this,"loadingState",t.ref(null));m(this,"attributes",t.reactive({items:[],showing:0,perPage:0,total:0}));return this.filter=new Ae(e),new Proxy(this,{get(s,n,r){if(Reflect.has(s,n))return Reflect.get(s,n,r);if(Reflect.has(s.filter.query,n)){const i=n.split(".");if(i.length>1){let a=s.filter.query;for(let l=0;l<i.length;l++)a=a[i[l]];return a??void 0}return Reflect.get(s.filter.query,n)}},set(s,n,r,i){if(Reflect.has(s,n))return Reflect.set(s,n,r,i);if(Reflect.has(s.filter.query,n)){const a=n.split(".");if(a.length>1){let l=s.form;for(let d=0;d<a.length-1;d++)a[d]in l||(l[a[d]]={}),l=l[a[d]];return l[a[a.length-1]]===void 0?!1:(l[a[a.length-1]]=r,!0)}return Reflect.set(s.filter.query,n,r)}return!1}})}get config(){return{data:this.attributes.items,total:this.attributes.total,currentPage:this.filter.query.page,perPage:this.filter.query.perPage,loading:this.isLoading,paginated:this.attributes.total>this.attributes.perPage,backendPagination:!0,striped:!0}}get events(){return{pageChange:e=>this.onPageChange(e)}}get isLoading(){return this.loadingState.value==="loading"}static create(e){return new C(e)}search(e={}){return typeof e=="function"?e=Object.assign({},this.filter.query,e(this.filter.query)):e=Object.assign({},this.filter.query,e),this.loading(),f.get(this.loadUrl,{params:e}).then(s=>(s.data.listing&&Object.assign(this.attributes,s.data.listing),s.data.filters&&(this.filter.applied=s.data.filters),this.filter.apply(),s)).finally(()=>{this.loadingState.value="loaded"})}load(e={}){return this.filter.query.page=1,typeof e=="function"?e=Object.assign({},this.filter.query,e(this.filter.query)):e=Object.assign({},this.filter.query,e),this.loading(),f.get(this.loadUrl,{params:e}).then(s=>(s.data.listing&&Object.assign(this.attributes,s.data.listing),s.data.filters&&(this.filter.applied=s.data.filters),s)).finally(()=>{this.loadingState.value="loaded"})}loading(){this.loadingState.value="loading"}onPageChange(e){return this.filter.query.page=e,this.search()}loadFrom(e){return this.loadUrl=e,this}}const Me={name:"WyxosForm",props:{form:{type:y,required:!0},submit:{type:[Function,Promise],default:null},listing:{type:C,default:null},reset:{type:[Boolean,Function],default:!1},formClass:{type:[String,Array,Object],default:null}},emits:["submitted"],methods:{async handle(){if(this.submit?await this.submit(this.form):await this.form.submit(),this.reset&&(typeof this.reset=="function"?this.reset():this.form.reset()),this.$emit("submitted"),this.listing)return this.listing.reload()}}};function Ie(o,e,s,n,r,i){const a=t.resolveComponent("o-loading"),l=t.resolveComponent("o-button");return s.form.isLoaded?(t.openBlock(),t.createElementBlock("form",{key:0,class:t.normalizeClass(s.formClass),onSubmit:e[0]||(e[0]=t.withModifiers(d=>i.handle(),["prevent"]))},[t.renderSlot(o.$slots,"default")],34)):s.form.isLoading?(t.openBlock(),t.createBlock(a,{key:1,active:!0})):s.form.isFailure?(t.openBlock(),t.createBlock(l,{key:2,onClick:e[1]||(e[1]=d=>s.form.load())},{default:t.withCtx(()=>e[2]||(e[2]=[t.createTextVNode(" Error. Retry or refresh. ")])),_:1})):t.createCommentVNode("",!0)}const v=h(Me,[["render",Ie]]),ze=Object.freeze(Object.defineProperty({__proto__:null,default:v},Symbol.toStringTag,{value:"Module"})),K={__name:"WyxosIcon",props:{active:{type:Boolean,required:!1},on:{type:String,required:!1,default:"chevron-down"},off:{type:String,required:!1,default:"chevron-right"}},setup(o){return(e,s)=>(t.openBlock(),t.createElementBlock("i",{class:t.normalizeClass([`fa-${o.active?o.on:o.off}`,"fas"])},null,2))}},De=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),Ue={name:"WyxosImage",props:{src:{type:[File,String],required:!0},resize:{type:Object,default:null}},emits:["loaded"],data(){return{instance:null,width:0,height:0}},mounted(){this.loadImage()},unmounted(){this.instance.onload=null},methods:{loadImage(){return typeof this.src=="object"?this.loadFile():this.loadPath()},loadFile(){this.instance=new FileReader,this.instance.onload=o=>{const e=o.target.result;this.$refs.image.src=e,this.width=this.resize?this.resize.width:e.width,this.height=this.resize?this.resize.height:e.height,this.$emit("loaded")},this.instance.readAsDataURL(this.src)},loadPath(){this.instance=new Image,this.instance.onload=()=>{this.$refs.image.src=this.src,this.width=this.resize?this.resize.width:this.instance.width,this.height=this.resize?this.resize.height:this.instance.height,this.$emit("loaded")},this.instance.src=this.src}}},Ye=["width","height"];function ve(o,e,s,n,r,i){return t.openBlock(),t.createElementBlock("img",{ref:"image",src:"",alt:"",width:r.width,height:r.height},null,8,Ye)}const J=h(Ue,[["render",ve]]),Ke=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"})),Je={class:"quick-edit"},He={class:"value"},Qe=["type","readonly"],Xe=["disabled"],Ge=["disabled"],Ze={key:0,class:"fas fa-check"},et={key:1,class:"fas fa-spinner fa-spin"},H={__name:"WyxosInlineEdit",props:{modelValue:{type:[String,Number,null],required:!0},update:{type:Function,required:!0},processing:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:e}){const s=o,n=e,r=t.ref(s.modelValue),i=t.ref(!1),a=()=>{i.value=!1,r.value=s.modelValue},l=()=>s.update(r.value).then(()=>{n("update:modelValue",r.value),i.value=!1});return(d,u)=>(t.openBlock(),t.createElementBlock("div",Je,[i.value?t.createCommentVNode("",!0):t.renderSlot(d.$slots,"value",{key:0},()=>[t.createElementVNode("span",He,t.toDisplayString(o.modelValue),1)]),i.value?t.renderSlot(d.$slots,"field",{key:1,query:r.value},()=>[i.value?t.withDirectives((t.openBlock(),t.createElementBlock("input",{key:0,"onUpdate:modelValue":u[0]||(u[0]=_=>r.value=_),type:typeof o.modelValue=="number"?"number":"text",readonly:o.processing},null,8,Qe)),[[t.vModelDynamic,r.value]]):t.createCommentVNode("",!0)]):t.createCommentVNode("",!0),t.renderSlot(d.$slots,"actions",{enableEdit:i.value,onCancel:a,onUpdate:l},()=>[i.value?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("button",{key:0,class:"edit",onClick:u[1]||(u[1]=_=>i.value=!0)},u[4]||(u[4]=[t.createElementVNode("i",{class:"fas fa-pencil-alt"},null,-1)]))),i.value?(t.openBlock(),t.createElementBlock("button",{key:1,class:"cancel",disabled:o.processing,onClick:u[2]||(u[2]=_=>a())},u[5]||(u[5]=[t.createElementVNode("i",{class:"fas fa-times"},null,-1)]),8,Xe)):t.createCommentVNode("",!0),i.value?(t.openBlock(),t.createElementBlock("button",{key:2,class:"save",disabled:o.processing,onClick:u[3]||(u[3]=_=>l())},[o.processing?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("i",Ze)),o.processing?(t.openBlock(),t.createElementBlock("i",et)):t.createCommentVNode("",!0)],8,Ge)):t.createCommentVNode("",!0)])]))}},tt=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"})),st={name:"WyxosInput",props:{label:{type:String,default:""},readonly:{type:Boolean,default:!1},name:{type:String,required:!0},bag:{type:String,default:()=>"default"},type:{type:String,default:"text"},clearable:{type:Boolean,default:!1},fieldClass:{type:String,default:null},inputRootClass:{type:String,default:null},inputClass:{type:String,default:null},modelValue:{type:[String,Number,null],default:null},form:{type:y,default:null},disabled:{type:[Boolean,String],default:null},placeholder:{type:String,default:null},passwordReveal:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(){return{errors:x()}},computed:{getError(){if(this.name)return this.form?this.form.getError(this.name):this.errors.get(this.name,this.bag)}},methods:{onInput(o){this.form?this.form.clearError(this.name):this.errors.clear(this.name,this.bag),this.$emit("update:modelValue",o)}}};function ot(o,e,s,n,r,i){const a=t.resolveComponent("o-input"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({class:s.fieldClass,label:s.label},i.getError),{default:t.withCtx(()=>[t.createVNode(a,{class:t.normalizeClass(s.inputClass),clearable:s.clearable,disabled:s.disabled,"model-value":s.modelValue,name:s.name,"password-reveal":s.passwordReveal,placeholder:s.placeholder,readonly:s.readonly,"root-class":s.inputRootClass,type:s.type,"onUpdate:modelValue":e[0]||(e[0]=d=>i.onInput(d))},null,8,["class","clearable","disabled","model-value","name","password-reveal","placeholder","readonly","root-class","type"])]),_:1},16,["class","label"])}const Q=h(st,[["render",ot]]),nt=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"})),rt={name:"WyxosListing",props:{listing:{type:C,required:!0}},computed:{allPropsAndEvents(){return{...this.listing.config,...Object.keys(this.listing.events).reduce((o,e)=>(o[`on${e.charAt(0).toUpperCase()+e.slice(1)}`]=this.listing.events[e],o),{})}}}},it={key:0},at={key:1},lt={key:2};function dt(o,e,s,n,r,i){const a=t.resolveComponent("o-table");return t.openBlock(),t.createBlock(a,t.normalizeProps(t.guardReactiveProps(i.allPropsAndEvents)),t.createSlots({empty:t.withCtx(()=>[s.listing.isEmpty?(t.openBlock(),t.createElementBlock("p",it,"No records found.")):t.createCommentVNode("",!0),s.listing.isSearchEmpty?(t.openBlock(),t.createElementBlock("p",at," No results for your query. Please adjust your search and try again. ")):t.createCommentVNode("",!0),s.listing.isFailure?(t.openBlock(),t.createElementBlock("p",lt," Failure to load the list. Try again or reload the page. ")):t.createCommentVNode("",!0)]),_:2},[t.renderList(o.$slots,(l,d)=>({name:d,fn:t.withCtx(u=>[t.renderSlot(o.$slots,d,t.normalizeProps(t.guardReactiveProps(u)))])}))]),1040)}const X=h(rt,[["render",dt]]),ct=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),ut={name:"WyxosLiveInput",props:{label:{type:String,default:""},readonly:{type:Boolean,default:!1},name:{type:String,required:!0},bag:{type:String,default:()=>"default"},type:{type:String,default:"text"},clearable:{type:Boolean,default:!1},fieldClass:{type:String,default:null},inputRootClass:{type:String,default:null},inputClass:{type:String,default:null},modelValue:{type:[String,Number,null],default:null},form:{type:y,default:null},disabled:{type:[Boolean,String],default:null},placeholder:{type:String,default:null}},emits:["update:modelValue"],setup(){return{errors:x()}},methods:{onInput(o){if(!this.name){this.$emit("update:modelValue",o);return}if(this.form)return this.form.clearError(this.name),this.form.submit(null,{formatter:()=>({field:this.name,value:o})});this.errors.clear(this.name,this.bag),this.$emit("update:modelValue",o)},getError(){if(this.name)return this.form?this.form.getError(this.name):this.errors.get(this.name)}}};function mt(o,e,s,n,r,i){const a=t.resolveComponent("o-input"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({label:s.label,class:s.fieldClass},{...i.getError()}),{default:t.withCtx(()=>[t.createVNode(a,{readonly:s.readonly,class:t.normalizeClass(s.inputClass),"root-class":s.inputRootClass,name:s.name,type:s.type,clearable:s.clearable,disabled:s.disabled,"model-value":s.modelValue,placeholder:s.placeholder,"onUpdate:modelValue":e[0]||(e[0]=d=>i.onInput(d))},null,8,["readonly","class","root-class","name","type","clearable","disabled","model-value","placeholder"])]),_:1},16,["label","class"])}const G=h(ut,[["render",mt]]),ft=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"})),ht={name:"WyxosLogout",props:{path:{type:String,default:"/logout"}},methods:{async logout(){const{data:o}=await f.post(this.path).catch(e=>{throw e.response.status===401&&(window.location.href="/"),e});window.location.href=(o==null?void 0:o.redirect)||"/"}}};function pt(o,e,s,n,r,i){return t.renderSlot(o.$slots,"default",{logout:i.logout},()=>[t.createElementVNode("button",{class:"button is-primary",onClick:e[0]||(e[0]=a=>i.logout())},"Sign out")])}const Z=h(ht,[["render",pt]]),gt=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),yt=t.defineComponent({name:"WyxosProgress",props:{showValue:{type:Boolean,default:!0},modelValue:{type:Number,required:!0},max:{type:Number,required:!0},format:{type:String,default:"percent"}}}),bt=["max","value"],_t={key:0};function St(o,e,s,n,r,i){return t.openBlock(),t.createElementBlock(t.Fragment,null,[t.createElementVNode("progress",{max:o.max,value:o.modelValue},null,8,bt),o.showValue?(t.openBlock(),t.createElementBlock("span",_t,t.toDisplayString(o.modelValue)+" / "+t.toDisplayString(o.max),1)):t.createCommentVNode("",!0)],64)}const ee=h(yt,[["render",St]]),kt=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"})),wt={name:"WyxosPrompt",props:{title:{type:String,default:null},message:{type:String,default:null},confirmText:{type:String,default:null},cancelText:{type:String,default:null},loading:{type:Boolean,default:!1},callback:{type:Function,default:null}},emits:["close"],setup(){return{state:new k}},methods:{async proceed(){this.callback&&(this.state.loading(),await this.callback().catch(o=>{throw this.state.failed(),o}),this.state.loaded()),this.$emit("close",{action:!0})}}},Ct={class:"flex gap-6"};function Vt(o,e,s,n,r,i){const a=t.resolveComponent("wyxos-button"),l=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{active:!0,onBlur:e[2]||(e[2]=d=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createElementVNode("h2",null,t.toDisplayString(s.title),1),t.createElementVNode("p",null,t.toDisplayString(s.message),1),t.createElementVNode("div",Ct,[t.createVNode(a,{disabled:n.state.isLoading,class:"button is-danger","native-type":"button",onClick:e[0]||(e[0]=d=>o.$emit("close",{action:!1}))},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.cancelText),1)]),_:1},8,["disabled"]),t.createVNode(a,{loading:n.state.isLoading,class:"button","native-type":"button",onClick:e[1]||(e[1]=d=>i.proceed())},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(s.confirmText),1)]),_:1},8,["loading"])])]),_:1})}const O=h(wt,[["render",Vt]]),xt=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"})),Et={name:"WyxosRemove",props:{listing:{type:C,default:null},route:{type:String,required:!0}},emits:["removed","failed"],setup(){return{destroy:y.create()}},data(){return{isVisible:!1}},methods:{async onRemove(){this.isVisible=!0},remove(){this.destroy.delete(this.route).then(()=>{this.$emit("removed"),this.listing&&this.listing.reload(),this.isVisible=!1}).catch(()=>{this.$emit("failed")})}}},Bt={class:"content p-6"},$t={class:"buttons flex gap-6 justify-end"};function Ot(o,e,s,n,r,i){const a=t.resolveComponent("o-button"),l=t.resolveComponent("w-button"),d=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{class:"button is-danger",onClick:e[3]||(e[3]=u=>i.onRemove())},{default:t.withCtx(()=>[t.renderSlot(o.$slots,"button",{},()=>[e[4]||(e[4]=t.createElementVNode("i",{class:"fas fa-trash"},null,-1))]),r.isVisible?(t.openBlock(),t.createBlock(t.Teleport,{key:0,to:"body"},[t.createVNode(d,{active:r.isVisible,"onUpdate:active":e[2]||(e[2]=u=>r.isVisible=u)},{default:t.withCtx(()=>[t.createElementVNode("div",Bt,[t.renderSlot(o.$slots,"title",{},()=>[e[5]||(e[5]=t.createElementVNode("h3",{class:"title"},"Delete",-1))]),t.renderSlot(o.$slots,"message",{},()=>[e[6]||(e[6]=t.createElementVNode("p",{class:"mb-4"}," Are you sure you want to delete this record? ",-1))]),t.createElementVNode("div",$t,[t.createVNode(a,{class:"button is-secondary",onClick:e[0]||(e[0]=u=>r.isVisible=!1)},{default:t.withCtx(()=>e[7]||(e[7]=[t.createTextVNode("Cancel ")])),_:1}),t.createVNode(l,{loading:n.destroy.isSubmitting,class:"button is-danger",onClick:e[1]||(e[1]=u=>i.remove())},{default:t.withCtx(()=>[t.renderSlot(o.$slots,"confirm",{},()=>[e[8]||(e[8]=t.createTextVNode("Confirm"))])]),_:3},8,["loading"])])])]),_:3},8,["active"])])):t.createCommentVNode("",!0)]),_:3})}const te=h(Et,[["render",Ot]]),Nt=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"})),Tt={name:"WyxosSelect",props:{label:{type:String,default:null},placeholder:{type:String,default:null},disabled:{type:Boolean,default:null},name:{type:String,default:null},modelValue:{type:[null,String,Number],required:!0},form:{type:y,default:null},items:{type:Array,default:null}},emits:["update:modelValue"],methods:{updateValue(o){var e;(e=this.form)==null||e.clearError(this.name),this.$emit("update:modelValue",o)}}},Pt=["value"];function Wt(o,e,s,n,r,i){var d;const a=t.resolveComponent("o-select"),l=t.resolveComponent("o-field");return t.openBlock(),t.createBlock(l,t.mergeProps({label:s.label},(d=s.form)==null?void 0:d.getError(s.name)),{default:t.withCtx(()=>[t.createVNode(a,{disabled:s.disabled,"model-value":s.modelValue,name:s.name,placeholder:s.placeholder,"root-class":"w-full","select-class":"w-full","onUpdate:modelValue":e[0]||(e[0]=u=>i.updateValue(u))},{default:t.withCtx(()=>[t.renderSlot(o.$slots,"default",{},()=>[s.items?(t.openBlock(!0),t.createElementBlock(t.Fragment,{key:0},t.renderList(s.items,u=>(t.openBlock(),t.createElementBlock("option",{key:u.value,value:u.value},t.toDisplayString(u.label),9,Pt))),128)):t.createCommentVNode("",!0)])]),_:3},8,["disabled","model-value","name","placeholder"])]),_:3},16,["label"])}const se=h(Tt,[["render",Wt]]),jt=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),qt={name:"WyxosSessionExpired",emits:["close"],setup(){return{login:y.create({email:null,password:null})}},data(){return{user:null,propertiesCount:0,organisations:[]}},methods:{async proceed(){await this.login.submit("/login"),this.$emit("close",{action:!0})},onLogout(){window.location.href="/"}}},Ft={class:"bg-white p-6"},Lt={class:"buttons"};function Rt(o,e,s,n,r,i){const a=t.resolveComponent("wyxos-input"),l=t.resolveComponent("w-button"),d=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(d,{active:!0},{default:t.withCtx(()=>[t.createElementVNode("div",Ft,[e[6]||(e[6]=t.createElementVNode("h2",{class:"title"},"Session Expired",-1)),e[7]||(e[7]=t.createElementVNode("p",{class:"mb-6"}," It looks like you've been away for a bit. For your security, please re-enter your credentials to continue. ",-1)),t.createElementVNode("form",{onSubmit:e[3]||(e[3]=t.withModifiers((...u)=>i.proceed&&i.proceed(...u),["prevent"]))},[t.createVNode(a,{modelValue:n.login.email,"onUpdate:modelValue":e[0]||(e[0]=u=>n.login.email=u),name:"email",label:"Email"},null,8,["modelValue"]),t.createVNode(a,{modelValue:n.login.password,"onUpdate:modelValue":e[1]||(e[1]=u=>n.login.password=u),name:"password",label:"Password",type:"password"},null,8,["modelValue"]),t.createElementVNode("div",Lt,[t.createVNode(l,{class:"button is-danger",disabled:n.login.isSubmitting,onClick:e[2]||(e[2]=u=>i.onLogout())},{default:t.withCtx(()=>e[4]||(e[4]=[t.createTextVNode(" Logout ")])),_:1},8,["disabled"]),t.createVNode(l,{class:"button is-primary","native-type":"submit",loading:n.login.isSubmitting},{default:t.withCtx(()=>e[5]||(e[5]=[t.createTextVNode(" Login ")])),_:1},8,["loading"])])],32)])]),_:1})}const N=h(qt,[["render",Rt]]),At=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"})),Mt={name:"WyxosSubmit",props:{form:{type:y,required:!0},labels:{type:Object,default(){return{submit:"Submit",submitting:"Processing",submitted:"Complete",failed:"Retry"}}}},data(){return{mergedLabels:{submit:"Submit",submitting:"Processing",submitted:"Complete",failed:"Retry"}}},watch:{labels:{deep:!0,handler(o){this.mergedLabels={...this.mergedLabels,...o}}}},created(){this.mergedLabels={...this.mergedLabels,...this.labels}}},It={key:0},zt={key:1},Dt={key:2},Ut={key:3};function Yt(o,e,s,n,r,i){const a=t.resolveComponent("o-button");return t.openBlock(),t.createBlock(a,{disabled:!!(s.form.isSubmitting||s.form.isSubmitted),"native-type":"submit"},{default:t.withCtx(()=>[!s.form.isSubmitted&&!s.form.isSubmitting&&!s.form.isSubmitFailed?(t.openBlock(),t.createElementBlock("span",It,t.toDisplayString(r.mergedLabels.submit),1)):t.createCommentVNode("",!0),s.form.isSubmitting?(t.openBlock(),t.createElementBlock("span",zt,[t.createTextVNode(t.toDisplayString(r.mergedLabels.submitting)+" ",1),e[0]||(e[0]=t.createElementVNode("i",{class:"fas fa-spinner fa-spin"},null,-1))])):t.createCommentVNode("",!0),s.form.isSubmitted?(t.openBlock(),t.createElementBlock("span",Dt,t.toDisplayString(r.mergedLabels.submitted),1)):t.createCommentVNode("",!0),s.form.isSubmitFailed?(t.openBlock(),t.createElementBlock("span",Ut,t.toDisplayString(r.mergedLabels.failed),1)):t.createCommentVNode("",!0)]),_:1},8,["disabled"])}const oe=h(Mt,[["render",Yt]]),vt=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),ne={__name:"WyxosTab",props:{active:{type:String,required:!0},hashKey:{type:String,default:()=>`tab-${Math.random().toString(36).slice(2,11)}`},responsiveResolution:{type:Number,default:768}},emits:["update:active"],setup(o,{emit:e}){const s=o,n=e,r=()=>{const p=window.location.hash.replace("#",""),g=new URLSearchParams(p);return Object.fromEntries(g.entries())},i=(p,g)=>{const F=window.location.hash.replace("#",""),S=new URLSearchParams(F);S.set(p,g),window.location.hash=S.toString()},a=t.ref(r()[s.hashKey]||s.active),l=t.ref(!1),d=p=>l.value?!0:p===a.value,u=()=>{l.value=window.innerWidth<=s.responsiveResolution},_=p=>{a.value=p,n("update:active",p),i(s.hashKey,p)};return t.onMounted(()=>{window.addEventListener("hashchange",()=>{const p=r();p[s.hashKey]&&(a.value=p[s.hashKey])}),u(),window.addEventListener("resize",u)}),t.onUnmounted(()=>{window.removeEventListener("hashchange",()=>{}),window.removeEventListener("resize",u)}),(p,g)=>(t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(p.$slots,"navigation",{isActive:d,setActive:_},()=>[g[0]||(g[0]=t.createTextVNode(" Fill in navigation content here "))]),t.renderSlot(p.$slots,"content",{isActive:d},()=>[g[1]||(g[1]=t.createTextVNode(" Fill in content here"))])]))}},Kt=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));class ${constructor(e={}){m(this,"state",new k);m(this,"result",t.ref([]));m(this,"value",t.ref(null));m(this,"timeout",null);m(this,"options",{url:null,payload:null,field:null});Object.assign(this.options,e)}get getConfig(){return{data:this.result.value,field:this.options.field,modelValue:this.value.value}}static create(e){return new $(e)}getEvents({searchPayloadFormatter:e=null}={}){return{"update:model-value":s=>(this.value.value=s,this.search(e))}}search(e){const s={value:this.value.value},n=e?e(s):s;return this.customSearch({payload:n})}async customSearch({url:e,payload:s}){this.timeout&&(this.controller.abort(),clearTimeout(this.timeout)),this.controller=new AbortController,this.timeout=setTimeout(async()=>{this.state.loading(),this.reset();const n=e||this.options.url,{data:r}=await f.post(`${n}/search`,s||this.options.payload,{signal:this.controller.signal}).catch(i=>{throw this.state.failed(),i});this.result.value=r.result,this.state.loaded()},500)}async restore(e,s){this.state.loading(),this.reset();const n=e||this.options.url,{data:r}=await f.post(`${n}/restore`,s||this.options.payload).catch(i=>{throw this.state.failed(),i});return this.state.loaded(),r}reset(){this.result.value=[]}}const Jt={name:"WyxosTags",props:{path:{type:String,required:!0},modelValue:{type:Array,required:!0},formatter:{type:Function,required:!0},excludeFormatter:{type:Function,default:null},restoreFormatter:{type:Function,default:o=>o},payloadFormatter:{type:Function,default:o=>o},openOnFocus:{type:Boolean,default:!1}},emits:["update:modelValue","update:query","change"],setup(){return{search:$.create()}},data(){return{query:[],isInternalChange:!1}},watch:{modelValue:{handler:async function(o,e){this.isInternalChange?this.isInternalChange=!1:JSON.stringify(o)!==JSON.stringify(e)&&this.restore()},deep:!0,immediate:!1}},async mounted(){this.restore()},methods:{async restore(){if(this.modelValue&&this.modelValue.length){this.isInternalChange=!0;const{result:o}=await this.search.restore(this.path,this.restoreFormatter({values:this.modelValue}));this.query=o,this.$emit("update:modelValue",this.query.map(e=>this.formatter(e))),this.$emit("update:query",this.query)}},onTagSearch(o){return this.search.customSearch({url:this.path,payload:this.payloadFormatter({value:o,exclude:this.query.map(e=>this.excludeFormatter(e)).filter(Boolean)})})},onTagAdded(){this.isInternalChange=!0;const o=this.query.map(e=>this.formatter(e));this.$emit("update:modelValue",o),this.$emit("update:query",this.query),this.$emit("change")},onTagRemoved(){this.isInternalChange=!0;const o=this.query.map(e=>this.formatter(e));this.$emit("update:modelValue",o),this.$emit("update:query",this.query),this.$emit("change")},reset(){this.isInternalChange=!0,this.query=[],this.$emit("update:modelValue",this.query),this.$emit("update:query",this.query)},addItem(){this.$refs.tagInput.addItem()},focus(){this.openOnFocus&&this.onTagSearch("")}}};function Ht(o,e,s,n,r,i){const a=t.resolveComponent("o-taginput");return t.openBlock(),t.createBlock(a,t.mergeProps({ref:"tagInput",modelValue:r.query,"onUpdate:modelValue":e[0]||(e[0]=l=>r.query=l),data:n.search.result.value,"open-on-focus":s.openOnFocus,"allow-autocomplete":""},o.$attrs,{onAdd:e[1]||(e[1]=l=>i.onTagAdded(l)),onFocus:e[2]||(e[2]=l=>i.onTagSearch("")),onRemove:e[3]||(e[3]=l=>i.onTagRemoved(l)),onTyping:e[4]||(e[4]=l=>i.onTagSearch(l))}),null,16,["modelValue","data","open-on-focus"])}const re=h(Jt,[["render",Ht]]),Qt=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"})),Xt={name:"WyxosTokenExpired",emits:["close"],methods:{async proceed(){this.$emit("close",{action:!0})}}},Gt={class:"bg-white p-6"},Zt={class:"buttons"};function es(o,e,s,n,r,i){const a=t.resolveComponent("w-button"),l=t.resolveComponent("o-modal");return t.openBlock(),t.createBlock(l,{active:!0},{default:t.withCtx(()=>[t.createElementVNode("div",Gt,[e[2]||(e[2]=t.createElementVNode("h2",{class:"title"},"Session expired",-1)),e[3]||(e[3]=t.createElementVNode("p",{class:"mb-6"}," Your tab has been idle for a while. We've refreshed your session for you. If you encountered an error after performing an action, please close this prompt and try again. ",-1)),t.createElementVNode("div",Zt,[t.createVNode(a,{class:"button is-primary",onClick:e[0]||(e[0]=d=>o.$emit("close",{action:!0}))},{default:t.withCtx(()=>e[1]||(e[1]=[t.createTextVNode(" Confirm ")])),_:1})])])]),_:1})}const T=h(Xt,[["render",es]]),ts=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"})),P={UK_TIME:"DD/MM/YYYY HH:mm:ss",UK:"DD/MM/YYYY",DB_TIME:"YYYY-MM-DD HH:mm:ss",DB:"YYYY-MM-DD"};class ie{constructor(e,s){m(this,"date",null);m(this,"empty","");this.date=e,this.empty=s}static load(e,s=""){return new this(e,s)}format(e,s=P.UK,n=""){return e?V(e).format(s):n||this.empty}render(e=P.UK,s=""){return this.format(this.date,e,s)}}m(ie,"FORMATS",P);class ss{constructor(e){this.data=new FormData,this.form=e,this.copy=Object.assign({},JSON.parse(JSON.stringify(e)))}static build(e,s){return new this(e).files(s).get()}static callback(e){return s=>this.build(s,e).get()}files(e){return e.forEach(s=>{typeof s=="object"?(this.data.append(s.name,s.value),delete this.copy[s.name]):this.form[s]&&(this.data.append(s,this.form[s]),delete this.copy[s])}),this}add(e,s){return this.data.append(e,s),this}get(){return this.data.append("payload",JSON.stringify(this.copy)),this.data}}class W{constructor(){m(this,"state",t.ref(!1))}get isVisible(){return this.state}static create(){return new W}show(){this.state=!0}hide(){this.state=!1}}class os{static create(e,s=null,n=null){return s=s||e,{value:e,label:s}}}class ns{constructor(){m(this,"structure",{});m(this,"query",t.reactive({items:[],perPage:0,total:0,isLoading:!1,isLoaded:!1,isFilterActive:!1}));m(this,"params",t.reactive({page:1}));m(this,"router",null)}static create(e,s={},n={},r){n=Object.assign({base:"/api/admin",route:`${e}.index`},n);const i=n.base,a={route:n.route,index:n.index||`${i}/${e}/index`,destroy:`${i}/${e}/destroy`},l=new this;return l.options=n,l.structure=s,l.params=Object.assign(l.params,s),l.router=r,l.urls=a,l}async fetch(e){this.query.isLoading=!0,this.query.isLoaded=!1;const{data:s}=await f.get(e||this.urls.index,{params:this.params}).catch(n=>{throw this.query.isLoading=!1,n});return await this.router.push({name:this.urls.route,query:this.params}),this.query.isLoading=!1,this.query.isLoaded=!0,s}async load(e){const s=await this.fetch(e);return Object.assign(this.query,s.query,{items:s.query.items.map(n=>({...n,isProcessing:!1}))}),s}onPageChange(e){return this.params.page=e,this.load()}async action(e,{row:s,index:n,remove:r,method:i},a={}){s.isProcessing=!0;const l={id:s.id,...a};if(i==="delete"){const{data:d}=await f.delete(e,{data:l}).catch(u=>{throw s.isProcessing=!1,u});s.isProcessing=!1,d.row&&Object.assign(s,d.row)}else{const{data:d}=await f.post(e,l).catch(u=>{throw s.isProcessing=!1,u});s.isProcessing=!1,d.row&&Object.assign(s,d.row)}if(r){const d=await this.fetch();if(this.query.items.splice(n,1),!d.query.items.length){this.params.page--,await this.load();return}this.query.items.length<d.query.items.length&&this.query.items.push(d.query.items[d.query.items.length-1])}}destroy(e,s){return this.action(this.urls.destroy,{...e,remove:!0},s)}async resetFilter(e=null){Object.assign(this.params,this.structure),this.query.isFilterActive=!1,await this.load(e)}}class rs{constructor(e){m(this,"current",t.ref(null));m(this,"history",t.ref([]));m(this,"flow",[]);this.current.value=e}is(e){return this.current.value===e}isAny(...e){return!!e.includes(this.current.value)}setFlow(e){this.flow=e}next(){const e=this.flow.findIndex(n=>n===this.getCurrent()),s=this.flow[e+1];if(s){this.set(s);return}throw Error(`No step defined after ${this.getCurrent()}`)}set(e){this.current.value=e,this.history.value.push(e)}previous(){this.history.value.pop(),this.current.value=this.history.value[this.history.value.length-1]}getCurrent(){return this.current.value}assign(e){Object.assign(this,e)}}class j{constructor(e){m(this,"attributes",t.reactive({name:null}));m(this,"callbacks",{});this.attributes.name=e}is(e){return this.attributes.name===e}onChange(e){this.callbacks=e}activeClass(e,s){return{class:this.is(e)?s:[]}}set(e){this.attributes.name=e,this.callbacks[e]&&this.callbacks[e]()}assign(e){Object.assign(this,e)}static create(e){return new j(e)}}class is{constructor(){m(this,"attributes",t.reactive({user:null}));m(this,"state",new k);return new Proxy(this,{get(e,s,n){return Reflect.has(e,s)?Reflect.get(e,s,n):s in e.attributes?e.attributes[s]:null},set(e,s,n,r){return!Reflect.has(e,s)&&!(s in e.attributes)?(Reflect.set(e,s,n,r),!0):s in e.attributes?(e.attributes[s]=n,!0):Reflect.set(e,s,n,r)}})}get isLoading(){return this.state.isLoading}get isLoaded(){return this.state.isLoaded}get isFailure(){return this.state.isFailure}get isAuthenticated(){return!!this.attributes.user}async load(){this.loading(),await f.get("/sanctum/csrf-cookie").catch(s=>{throw this.failed(),s});const{data:e}=await f.get("/api/user");if(!("user"in e))throw Error("Instance of user is not defined.");Object.keys(e).forEach(s=>{this.attributes[s]=e[s]}),this.loaded()}loading(){return this.state.loading()}loaded(){return this.state.loaded()}failed(){return this.state.failed()}reset(){this.attributes=t.reactive({user:null}),this.state.reset()}}const as=new is;async function ls(o={}){return(await B.useOruga().modal.open({component:O,props:Object.assign({title:"Confirm",message:"Are you sure you want proceed?",confirmText:"Yes",cancelText:"Cancel"},o),trapFocus:!0}).promise).action}async function ae(o,e){var i,a,l,d,u,_;if((o==null?void 0:o.code)==="ERR_CANCELED")return Promise.reject(o);const s={401:"Authentication required. Please reload the page and sign in.",403:"You do not have permission to perform this action.",404:"The page or action you are looking for could not be found.",419:"Your session has likely expired. Try again or reload the page.",422:"The action attempted was invalid. Please review your input and try again.",500:"An unexpected error has occurred. This issue has been reported.",503:"The site is currently under maintenance. Please try again later."};Object.assign(s,(e==null?void 0:e.messages)||{});const n=s[(i=o.response)==null?void 0:i.status]||s[500],r=B.useOruga();if(r.notification.open({message:n,duration:1e3*5,variant:"danger",position:"bottom-right",closable:!0}),((a=o.response)==null?void 0:a.status)===419){r.modal.open({component:((l=e.components)==null?void 0:l.TokenExpired)||T,trapFocus:!0,closable:!1});const g=(await f.get("/heartbeat")).data.csrfToken;f.defaults.headers.common["X-CSRF-TOKEN"]=g}if(((d=o.response)==null?void 0:d.status)===401&&r.modal.open({component:((u=e.components)==null?void 0:u.SessionExpired)||N,trapFocus:!0,closable:!1}),((_=o.response)==null?void 0:_.status)===422){const p=setInterval(()=>{const g=document.querySelectorAll(".o-field__message-danger, .wyxos-error"),F=w=>{const L=w.getBoundingClientRect(),E=window.getComputedStyle(w);return L.width>0&&L.height>0&&E.display!=="none"&&E.visibility!=="hidden"&&E.opacity!=="0"},S=Array.from(g).find(F);if(S){clearInterval(p);let w;if(S.classList.contains("o-field__message-danger")?w=S.closest(".o-field"):S.classList.contains("wyxos-error")&&(w=S.closest("label")),w){const E=w.getBoundingClientRect().top+window.scrollY-10;window.scrollTo({top:E,behavior:"smooth"})}else console.error("Could not determine the scroll target.")}},100)}return Promise.reject(o)}function ds(o){B.useOruga().notification.open({message:o||"Action successful.",duration:2500,variant:"success",position:"bottom-right",closable:!0})}function cs(o){f.interceptors.response.use(null,e=>ae(e,o))}const le=Object.assign({"./components/WyxosAccordion.vue":ce,"./components/WyxosAction.vue":he,"./components/WyxosButton.vue":Se,"./components/WyxosCollection.vue":Ce,"./components/WyxosConfirm.vue":Ne,"./components/WyxosDatepicker.vue":We,"./components/WyxosError.vue":Re,"./components/WyxosForm.vue":ze,"./components/WyxosIcon.vue":De,"./components/WyxosImage.vue":Ke,"./components/WyxosInlineEdit.vue":tt,"./components/WyxosInput.vue":nt,"./components/WyxosListing.vue":ct,"./components/WyxosLiveInput.vue":ft,"./components/WyxosLogout.vue":gt,"./components/WyxosProgress.vue":kt,"./components/WyxosPrompt.vue":xt,"./components/WyxosRemove.vue":Nt,"./components/WyxosSelect.vue":jt,"./components/WyxosSessionExpired.vue":At,"./components/WyxosSubmit.vue":vt,"./components/WyxosTab.vue":Kt,"./components/WyxosTags.vue":Qt,"./components/WyxosTokenExpired.vue":ts}),q={},us={install:(o,e={})=>{e={vision:{},oruga:{},use:{oruga:!0},...e},e.use.oruga&&o.use(B,e.oruga),Object.keys(le).forEach(s=>{const n=le[s];if(n&&n.default){const r=n.default,i=r.name;if(i)o.component(i,r),o.component(i.replace("Wyxos","W"),r),q[i]=r;else{const a=s.split("/").pop().split(".")[0];o.component(a,r),o.component(a.replace("Wyxos","W"),r),q[a]=r}}else console.error(`Could not load component from '${s}'`)}),o.config.globalProperties.$v={to:(s,n)=>({name:s,params:n})},cs(e)},...q};c.Action=A,c.DateRender=ie,c.FileRequest=ss,c.FormBuilder=y,c.Listing=C,c.LoadState=k,c.Modal=W,c.Option=os,c.ResourceList=ns,c.Search=$,c.Steps=rs,c.Tab=j,c.WyxosAccordion=R,c.WyxosAction=M,c.WyxosButton=I,c.WyxosCollection=z,c.WyxosConfirm=D,c.WyxosDatepicker=U,c.WyxosError=Y,c.WyxosForm=v,c.WyxosIcon=K,c.WyxosImage=J,c.WyxosInlineEdit=H,c.WyxosInput=Q,c.WyxosListing=X,c.WyxosLiveInput=G,c.WyxosLogout=Z,c.WyxosProgress=ee,c.WyxosPrompt=O,c.WyxosRemove=te,c.WyxosSelect=se,c.WyxosSessionExpired=N,c.WyxosSubmit=oe,c.WyxosTab=ne,c.WyxosTags=re,c.WyxosTokenExpired=T,c.auth=as,c.confirm=ls,c.default=us,c.errorHandler=ae,c.success=ds,c.useFormErrors=x,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=vision.umd.cjs.map
